<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.1" />
<title>brt API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Package <code>brt</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import pandas as pd
from pandasql import sqldf
import numpy as np 
import scipy.stats as stats
import warnings
from IPython.display import display, Markdown

 

def add_ff5(input:pd.DataFrame , sic: str = &#39;sic&#39;, code: str = &#39;ff5&#39;, description: str = None):
    &#39;&#39;&#39;    
    Add Fama-French 5-factor code and description.

    Parameters
    ----------
    input : TYPE
        Input data.
    sic : str, optional
        SIC column name. The default is &#39;sic&#39;.
    code : str, optional
        FF5 output column name. The default is &#39;ff5&#39;.
    description : str, optional
        FF5 description output column name. Description will only be added if it is not None. The default is None.

    Returns
    -------
    input : TYPE
        DataFrame with added FF5 code and description if &#39;description&#39; is not None.

    &#39;&#39;&#39;
    
     
    input[code] = np.nan
    if(description!=None):
        input[description] = np.nan
    input.loc[(input[sic].between(100,999)) | (input[sic].between(2000,2399)) | (input[sic].between(2700,2749)) | (input[sic].between(2770,2799)) | (input[sic].between(3100,3199)) | (input[sic].between(3940,3989)) | (input[sic].between(2500,2519)) | (input[sic].between(2590,2599)) | (input[sic].between(3630,3659)) | (input[sic].between(3710,3711)) | (input[sic].between(3714,3714)) | (input[sic].between(3716,3716)) | (input[sic].between(3750,3751)) | (input[sic].between(3792,3792)) | (input[sic].between(3900,3939)) | (input[sic].between(3990,3999)) | (input[sic].between(5000,5999)) | (input[sic].between(7200,7299)) | (input[sic].between(7600,7699)), code] = 1
    if(description!=None):
        input.loc[(input[sic].between(100,999)) | (input[sic].between(2000,2399)) | (input[sic].between(2700,2749)) | (input[sic].between(2770,2799)) | (input[sic].between(3100,3199)) | (input[sic].between(3940,3989)) | (input[sic].between(2500,2519)) | (input[sic].between(2590,2599)) | (input[sic].between(3630,3659)) | (input[sic].between(3710,3711)) | (input[sic].between(3714,3714)) | (input[sic].between(3716,3716)) | (input[sic].between(3750,3751)) | (input[sic].between(3792,3792)) | (input[sic].between(3900,3939)) | (input[sic].between(3990,3999)) | (input[sic].between(5000,5999)) | (input[sic].between(7200,7299)) | (input[sic].between(7600,7699)), description] = &#39;Cnsmr  Consumer Durables, Nondurables, Wholesale, Retail, and Some Services (Laundries, Repair Shops)&#39;
    input.loc[(input[sic].between(2520,2589)) | (input[sic].between(2600,2699)) | (input[sic].between(2750,2769)) | (input[sic].between(2800,2829)) | (input[sic].between(2840,2899)) | (input[sic].between(3000,3099)) | (input[sic].between(3200,3569)) | (input[sic].between(3580,3621)) | (input[sic].between(3623,3629)) | (input[sic].between(3700,3709)) | (input[sic].between(3712,3713)) | (input[sic].between(3715,3715)) | (input[sic].between(3717,3749)) | (input[sic].between(3752,3791)) | (input[sic].between(3793,3799)) | (input[sic].between(3860,3899)) | (input[sic].between(1200,1399)) | (input[sic].between(2900,2999)) | (input[sic].between(4900,4949)), code] = 2
    if(description!=None):
        input.loc[(input[sic].between(2520,2589)) | (input[sic].between(2600,2699)) | (input[sic].between(2750,2769)) | (input[sic].between(2800,2829)) | (input[sic].between(2840,2899)) | (input[sic].between(3000,3099)) | (input[sic].between(3200,3569)) | (input[sic].between(3580,3621)) | (input[sic].between(3623,3629)) | (input[sic].between(3700,3709)) | (input[sic].between(3712,3713)) | (input[sic].between(3715,3715)) | (input[sic].between(3717,3749)) | (input[sic].between(3752,3791)) | (input[sic].between(3793,3799)) | (input[sic].between(3860,3899)) | (input[sic].between(1200,1399)) | (input[sic].between(2900,2999)) | (input[sic].between(4900,4949)), description] = &#39;Manuf  Manufacturing, Energy, and Utilities&#39;
    input.loc[(input[sic].between(3570,3579)) | (input[sic].between(3622,3622)) | (input[sic].between(3660,3692)) | (input[sic].between(3694,3699)) | (input[sic].between(3810,3839)) | (input[sic].between(7370,7372)) | (input[sic].between(7373,7373)) | (input[sic].between(7374,7374)) | (input[sic].between(7375,7375)) | (input[sic].between(7376,7376)) | (input[sic].between(7377,7377)) | (input[sic].between(7378,7378)) | (input[sic].between(7379,7379)) | (input[sic].between(7391,7391)) | (input[sic].between(8730,8734)) | (input[sic].between(4800,4899)), code] = 3
    if(description!=None):
        input.loc[(input[sic].between(3570,3579)) | (input[sic].between(3622,3622)) | (input[sic].between(3660,3692)) | (input[sic].between(3694,3699)) | (input[sic].between(3810,3839)) | (input[sic].between(7370,7372)) | (input[sic].between(7373,7373)) | (input[sic].between(7374,7374)) | (input[sic].between(7375,7375)) | (input[sic].between(7376,7376)) | (input[sic].between(7377,7377)) | (input[sic].between(7378,7378)) | (input[sic].between(7379,7379)) | (input[sic].between(7391,7391)) | (input[sic].between(8730,8734)) | (input[sic].between(4800,4899)), description] = &#39;HiTec  Business Equipment, Telephone and Television Transmission&#39;
    input.loc[(input[sic].between(2830,2839)) | (input[sic].between(3693,3693)) | (input[sic].between(3840,3859)) | (input[sic].between(8000,8099)), code] = 4
    if(description!=None):
        input.loc[(input[sic].between(2830,2839)) | (input[sic].between(3693,3693)) | (input[sic].between(3840,3859)) | (input[sic].between(8000,8099)), description] = &#39;Hlth   Healthcare, Medical Equipment, and Drugs&#39;
    input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), code] = 5
    if(description!=None):
        input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), description] = &#39;Other  Other -- Mines, Constr, BldMt, Trans, Hotels, Bus Serv, Entertainment, Finance&#39;
    return input

def add_ff12(input:pd.DataFrame, sic=&#39;sic&#39;, code = &#39;ff12&#39;, description = None):
    &#39;&#39;&#39;    
    Add Fama-French 12-factor code and description.

    Parameters
    ----------
    input : TYPE
        Input data.
    sic : str, optional
        SIC column name. The default is &#39;sic&#39;.
    code : str, optional
        FF12 output column name. The default is &#39;ff12&#39;.
    description : str, optional
        FF12 description output column name. Description will only be added if it is not None. The default is None.

    Returns
    -------
    input : TYPE
        DataFrame with added FF12 code and description if &#39;description&#39; is not None.

    &#39;&#39;&#39;
    
    
    input[code] = np.nan
    if(description!=None):
        input[description] = np.nan
    input.loc[(input[sic].between(100,999)) | (input[sic].between(2000,2399)) | (input[sic].between(2700,2749)) | (input[sic].between(2770,2799)) | (input[sic].between(3100,3199)) | (input[sic].between(3940,3989)), code] = 1
    if(description!=None):
        input.loc[(input[sic].between(100,999)) | (input[sic].between(2000,2399)) | (input[sic].between(2700,2749)) | (input[sic].between(2770,2799)) | (input[sic].between(3100,3199)) | (input[sic].between(3940,3989)), description] = &#39;NoDur  Consumer Nondurables -- Food, Tobacco, Textiles, Apparel, Leather, Toys&#39;
    input.loc[(input[sic].between(2500,2519)) | (input[sic].between(2590,2599)) | (input[sic].between(3630,3659)) | (input[sic].between(3710,3711)) | (input[sic].between(3714,3714)) | (input[sic].between(3716,3716)) | (input[sic].between(3750,3751)) | (input[sic].between(3792,3792)) | (input[sic].between(3900,3939)) | (input[sic].between(3990,3999)), code] = 2
    if(description!=None):
        input.loc[(input[sic].between(2500,2519)) | (input[sic].between(2590,2599)) | (input[sic].between(3630,3659)) | (input[sic].between(3710,3711)) | (input[sic].between(3714,3714)) | (input[sic].between(3716,3716)) | (input[sic].between(3750,3751)) | (input[sic].between(3792,3792)) | (input[sic].between(3900,3939)) | (input[sic].between(3990,3999)), description] = &#39;Durbl  Consumer Durables -- Cars, TVs, Furniture, Household Appliances&#39;
    input.loc[(input[sic].between(2520,2589)) | (input[sic].between(2600,2699)) | (input[sic].between(2750,2769)) | (input[sic].between(3000,3099)) | (input[sic].between(3200,3569)) | (input[sic].between(3580,3629)) | (input[sic].between(3700,3709)) | (input[sic].between(3712,3713)) | (input[sic].between(3715,3715)) | (input[sic].between(3717,3749)) | (input[sic].between(3752,3791)) | (input[sic].between(3793,3799)) | (input[sic].between(3830,3839)) | (input[sic].between(3860,3899)), code] = 3
    if(description!=None):
        input.loc[(input[sic].between(2520,2589)) | (input[sic].between(2600,2699)) | (input[sic].between(2750,2769)) | (input[sic].between(3000,3099)) | (input[sic].between(3200,3569)) | (input[sic].between(3580,3629)) | (input[sic].between(3700,3709)) | (input[sic].between(3712,3713)) | (input[sic].between(3715,3715)) | (input[sic].between(3717,3749)) | (input[sic].between(3752,3791)) | (input[sic].between(3793,3799)) | (input[sic].between(3830,3839)) | (input[sic].between(3860,3899)), description] = &#39;Manuf  Manufacturing -- Machinery, Trucks, Planes, Off Furn, Paper, Com Printing&#39;
    input.loc[(input[sic].between(1200,1399)) | (input[sic].between(2900,2999)), code] = 4
    if(description!=None):
        input.loc[(input[sic].between(1200,1399)) | (input[sic].between(2900,2999)), description] = &#39;Enrgy  Oil, Gas, and Coal Extraction and Products&#39;
    input.loc[(input[sic].between(2800,2829)) | (input[sic].between(2840,2899)), code] = 5
    if(description!=None):
        input.loc[(input[sic].between(2800,2829)) | (input[sic].between(2840,2899)), description] = &#39;Chems  Chemicals and Allied Products&#39;
    input.loc[(input[sic].between(3570,3579)) | (input[sic].between(3660,3692)) | (input[sic].between(3694,3699)) | (input[sic].between(3810,3829)) | (input[sic].between(7370,7379)), code] = 6
    if(description!=None):
        input.loc[(input[sic].between(3570,3579)) | (input[sic].between(3660,3692)) | (input[sic].between(3694,3699)) | (input[sic].between(3810,3829)) | (input[sic].between(7370,7379)), description] = &#39;BusEq  Business Equipment -- Computers, Software, and Electronic Equipment&#39;
    input.loc[(input[sic].between(4800,4899)), code] = 7
    if(description!=None):
        input.loc[(input[sic].between(4800,4899)), description] = &#39;Telcm  Telephone and Television Transmission&#39;
    input.loc[(input[sic].between(4900,4949)), code] = 8
    if(description!=None):
        input.loc[(input[sic].between(4900,4949)), description] = &#39;Utils  Utilities&#39;
    input.loc[(input[sic].between(5000,5999)) | (input[sic].between(7200,7299)) | (input[sic].between(7600,7699)), code] = 9
    if(description!=None):
        input.loc[(input[sic].between(5000,5999)) | (input[sic].between(7200,7299)) | (input[sic].between(7600,7699)), description] = &#39;Shops  Wholesale, Retail, and Some Services (Laundries, Repair Shops)&#39;
    input.loc[(input[sic].between(2830,2839)) | (input[sic].between(3693,3693)) | (input[sic].between(3840,3859)) | (input[sic].between(8000,8099)), code] = 10
    if(description!=None):
        input.loc[(input[sic].between(2830,2839)) | (input[sic].between(3693,3693)) | (input[sic].between(3840,3859)) | (input[sic].between(8000,8099)), description] = &#39;Hlth   Healthcare, Medical Equipment, and Drugs&#39;
    input.loc[(input[sic].between(6000,6999)), code] = 11
    if(description!=None):
        input.loc[(input[sic].between(6000,6999)), description] = &#39;Money  Finance&#39;
    input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), code] = 12
    if(description!=None):
        input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), description] = &#39;Other  Other -- Mines, Constr, BldMt, Trans, Hotels, Bus Serv, Entertainment&#39;
    return input

def add_ff38(input:pd.DataFrame, sic=&#39;sic&#39;, code = &#39;ff38&#39;, description = None):
    
    &#39;&#39;&#39;    
    Add Fama-French 38-factor code and description.

    Parameters
    ----------
    input : TYPE
        Input data.
    sic : str, optional
        SIC column name. The default is &#39;sic&#39;.
    code : str, optional
        FF38 output column name. The default is &#39;ff38&#39;.
    description : str, optional
        FF38 description output column name. Description will only be added if it is not None. The default is None.

    Returns
    -------
    input : TYPE
        DataFrame with added FF38 code and description if &#39;description&#39; is not None.

    &#39;&#39;&#39;
    
    input[code] = np.nan
    if(description!=None):
        input[description] = np.nan
    input.loc[(input[sic].between(100,999)), code] = 1
    if(description!=None):
        input.loc[(input[sic].between(100,999)), description] = &#39;Agric  Agriculture, forestry, and fishing&#39;
    input.loc[(input[sic].between(1000,1299)), code] = 2
    if(description!=None):
        input.loc[(input[sic].between(1000,1299)), description] = &#39;Mines  Mining&#39;
    input.loc[(input[sic].between(1300,1399)), code] = 3
    if(description!=None):
        input.loc[(input[sic].between(1300,1399)), description] = &#39;Oil    Oil and Gas Extraction&#39;
    input.loc[(input[sic].between(1400,1499)), code] = 4
    if(description!=None):
        input.loc[(input[sic].between(1400,1499)), description] = &#39;Stone  Nonmetallic Minerals Except Fuels&#39;
    input.loc[(input[sic].between(1500,1799)), code] = 5
    if(description!=None):
        input.loc[(input[sic].between(1500,1799)), description] = &#39;Cnstr  Construction&#39;
    input.loc[(input[sic].between(2000,2099)), code] = 6
    if(description!=None):
        input.loc[(input[sic].between(2000,2099)), description] = &#39;Food   Food and Kindred Products&#39;
    input.loc[(input[sic].between(2100,2199)), code] = 7
    if(description!=None):
        input.loc[(input[sic].between(2100,2199)), description] = &#39;Smoke  Tobacco Products&#39;
    input.loc[(input[sic].between(2200,2299)), code] = 8
    if(description!=None):
        input.loc[(input[sic].between(2200,2299)), description] = &#39;Txtls  Textile Mill Products&#39;
    input.loc[(input[sic].between(2300,2399)), code] = 9
    if(description!=None):
        input.loc[(input[sic].between(2300,2399)), description] = &#39;Apprl  Apparel and other Textile Products&#39;
    input.loc[(input[sic].between(2400,2499)), code] = 10
    if(description!=None):
        input.loc[(input[sic].between(2400,2499)), description] = &#39;Wood   Lumber and Wood Products&#39;
    input.loc[(input[sic].between(2500,2599)), code] = 11
    if(description!=None):
        input.loc[(input[sic].between(2500,2599)), description] = &#39;Chair  Furniture and Fixtures&#39;
    input.loc[(input[sic].between(2600,2661)), code] = 12
    if(description!=None):
        input.loc[(input[sic].between(2600,2661)), description] = &#39;Paper  Paper and Allied Products&#39;
    input.loc[(input[sic].between(2700,2799)), code] = 13
    if(description!=None):
        input.loc[(input[sic].between(2700,2799)), description] = &#39;Print  Printing and Publishing&#39;
    input.loc[(input[sic].between(2800,2899)), code] = 14
    if(description!=None):
        input.loc[(input[sic].between(2800,2899)), description] = &#39;Chems  Chemicals and Allied Products&#39;
    input.loc[(input[sic].between(2900,2999)), code] = 15
    if(description!=None):
        input.loc[(input[sic].between(2900,2999)), description] = &#39;Ptrlm  Petroleum and Coal Products&#39;
    input.loc[(input[sic].between(3000,3099)), code] = 16
    if(description!=None):
        input.loc[(input[sic].between(3000,3099)), description] = &#39;Rubbr  Rubber and Miscellaneous Plastics Products&#39;
    input.loc[(input[sic].between(3100,3199)), code] = 17
    if(description!=None):
        input.loc[(input[sic].between(3100,3199)), description] = &#39;Lethr  Leather and Leather Products&#39;
    input.loc[(input[sic].between(3200,3299)), code] = 18
    if(description!=None):
        input.loc[(input[sic].between(3200,3299)), description] = &#39;Glass  Stone, Clay and Glass Products&#39;
    input.loc[(input[sic].between(3300,3399)), code] = 19
    if(description!=None):
        input.loc[(input[sic].between(3300,3399)), description] = &#39;Metal  Primary Metal Industries&#39;
    input.loc[(input[sic].between(3400,3499)), code] = 20
    if(description!=None):
        input.loc[(input[sic].between(3400,3499)), description] = &#39;MtlPr  Fabricated Metal Products&#39;
    input.loc[(input[sic].between(3500,3599)), code] = 21
    if(description!=None):
        input.loc[(input[sic].between(3500,3599)), description] = &#39;Machn  Machinery, Except Electrical&#39;
    input.loc[(input[sic].between(3600,3699)), code] = 22
    if(description!=None):
        input.loc[(input[sic].between(3600,3699)), description] = &#39;Elctr  Electrical and Electronic Equipment&#39;
    input.loc[(input[sic].between(3700,3799)), code] = 23
    if(description!=None):
        input.loc[(input[sic].between(3700,3799)), description] = &#39;Cars   Transportation Equipment&#39;
    input.loc[(input[sic].between(3800,3879)), code] = 24
    if(description!=None):
        input.loc[(input[sic].between(3800,3879)), description] = &#39;Instr  Instruments and Related Products&#39;
    input.loc[(input[sic].between(3900,3999)), code] = 25
    if(description!=None):
        input.loc[(input[sic].between(3900,3999)), description] = &#39;Manuf  Miscellaneous Manufacturing Industries&#39;
    input.loc[(input[sic].between(4000,4799)), code] = 26
    if(description!=None):
        input.loc[(input[sic].between(4000,4799)), description] = &#39;Trans  Transportation&#39;
    input.loc[(input[sic].between(4800,4829)), code] = 27
    if(description!=None):
        input.loc[(input[sic].between(4800,4829)), description] = &#39;Phone  Telephone and Telegraph Communication&#39;
    input.loc[(input[sic].between(4830,4899)), code] = 28
    if(description!=None):
        input.loc[(input[sic].between(4830,4899)), description] = &#39;TV     Radio and Television Broadcasting&#39;
    input.loc[(input[sic].between(4900,4949)), code] = 29
    if(description!=None):
        input.loc[(input[sic].between(4900,4949)), description] = &#39;Utils  Electric, Gas, and Water Supply&#39;
    input.loc[(input[sic].between(4950,4959)), code] = 30
    if(description!=None):
        input.loc[(input[sic].between(4950,4959)), description] = &#39;Garbg  Sanitary Services&#39;
    input.loc[(input[sic].between(4960,4969)), code] = 31
    if(description!=None):
        input.loc[(input[sic].between(4960,4969)), description] = &#39;Steam  Steam Supply&#39;
    input.loc[(input[sic].between(4970,4979)), code] = 32
    if(description!=None):
        input.loc[(input[sic].between(4970,4979)), description] = &#39;Water  Irrigation Systems&#39;
    input.loc[(input[sic].between(5000,5199)), code] = 33
    if(description!=None):
        input.loc[(input[sic].between(5000,5199)), description] = &#39;Whlsl  Wholesale&#39;
    input.loc[(input[sic].between(5200,5999)), code] = 34
    if(description!=None):
        input.loc[(input[sic].between(5200,5999)), description] = &#39;Rtail  Retail Stores&#39;
    input.loc[(input[sic].between(6000,6999)), code] = 35
    if(description!=None):
        input.loc[(input[sic].between(6000,6999)), description] = &#39;Money  Finance, Insurance, and Real Estate&#39;
    input.loc[(input[sic].between(7000,8999)), code] = 36
    if(description!=None):
        input.loc[(input[sic].between(7000,8999)), description] = &#39;Srvc   Services&#39;
    input.loc[(input[sic].between(9000,9999)), code] = 37
    if(description!=None):
        input.loc[(input[sic].between(9000,9999)), description] = &#39;Govt   Public Administration&#39;
    input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), code] = 38
    if(description!=None):
        input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), description] = &#39;Other  Almost Nothing&#39;
    return input

def add_ff48(input:pd.DataFrame, sic=&#39;sic&#39;, code = &#39;ff48&#39;, description = None):
    &#39;&#39;&#39;    
    Add Fama-French 48-factor code and description.

    Parameters
    ----------
    input : TYPE
        Input data.
    sic : str, optional
        SIC column name. The default is &#39;sic&#39;.
    code : str, optional
        FF48 output column name. The default is &#39;ff48&#39;.
    description : str, optional
        FF48 description output column name. Description will only be added if it is not None. The default is None.

    Returns
    -------
    input : TYPE
        DataFrame with added FF48 code and description if &#39;description&#39; is not None.

    &#39;&#39;&#39;
    
    
    input[code] = np.nan
    if(description!=None):
        input[description] = np.nan
    input.loc[(input[sic].between(100,199)) | (input[sic].between(200,299)) | (input[sic].between(700,799)) | (input[sic].between(910,919)) | (input[sic].between(2048,2048)), code] = 1
    if(description!=None):
        input.loc[(input[sic].between(100,199)) | (input[sic].between(200,299)) | (input[sic].between(700,799)) | (input[sic].between(910,919)) | (input[sic].between(2048,2048)), description] = &#39;Agric  Agriculture&#39;
    input.loc[(input[sic].between(2000,2009)) | (input[sic].between(2010,2019)) | (input[sic].between(2020,2029)) | (input[sic].between(2030,2039)) | (input[sic].between(2040,2046)) | (input[sic].between(2050,2059)) | (input[sic].between(2060,2063)) | (input[sic].between(2070,2079)) | (input[sic].between(2090,2092)) | (input[sic].between(2095,2095)) | (input[sic].between(2098,2099)), code] = 2
    if(description!=None):
        input.loc[(input[sic].between(2000,2009)) | (input[sic].between(2010,2019)) | (input[sic].between(2020,2029)) | (input[sic].between(2030,2039)) | (input[sic].between(2040,2046)) | (input[sic].between(2050,2059)) | (input[sic].between(2060,2063)) | (input[sic].between(2070,2079)) | (input[sic].between(2090,2092)) | (input[sic].between(2095,2095)) | (input[sic].between(2098,2099)), description] = &#39;Food   Food Products&#39;
    input.loc[(input[sic].between(2064,2068)) | (input[sic].between(2086,2086)) | (input[sic].between(2087,2087)) | (input[sic].between(2096,2096)) | (input[sic].between(2097,2097)), code] = 3
    if(description!=None):
        input.loc[(input[sic].between(2064,2068)) | (input[sic].between(2086,2086)) | (input[sic].between(2087,2087)) | (input[sic].between(2096,2096)) | (input[sic].between(2097,2097)), description] = &#39;Soda   Candy &amp; Soda&#39;
    input.loc[(input[sic].between(2080,2080)) | (input[sic].between(2082,2082)) | (input[sic].between(2083,2083)) | (input[sic].between(2084,2084)) | (input[sic].between(2085,2085)), code] = 4
    if(description!=None):
        input.loc[(input[sic].between(2080,2080)) | (input[sic].between(2082,2082)) | (input[sic].between(2083,2083)) | (input[sic].between(2084,2084)) | (input[sic].between(2085,2085)), description] = &#39;Beer   Beer &amp; Liquor&#39;
    input.loc[(input[sic].between(2100,2199)), code] = 5
    if(description!=None):
        input.loc[(input[sic].between(2100,2199)), description] = &#39;Smoke  Tobacco Products&#39;
    input.loc[(input[sic].between(920,999)) | (input[sic].between(3650,3651)) | (input[sic].between(3652,3652)) | (input[sic].between(3732,3732)) | (input[sic].between(3930,3931)) | (input[sic].between(3940,3949)), code] = 6
    if(description!=None):
        input.loc[(input[sic].between(920,999)) | (input[sic].between(3650,3651)) | (input[sic].between(3652,3652)) | (input[sic].between(3732,3732)) | (input[sic].between(3930,3931)) | (input[sic].between(3940,3949)), description] = &#39;Toys   Recreation&#39;
    input.loc[(input[sic].between(7800,7829)) | (input[sic].between(7830,7833)) | (input[sic].between(7840,7841)) | (input[sic].between(7900,7900)) | (input[sic].between(7910,7911)) | (input[sic].between(7920,7929)) | (input[sic].between(7930,7933)) | (input[sic].between(7940,7949)) | (input[sic].between(7980,7980)) | (input[sic].between(7990,7999)), code] = 7
    if(description!=None):
        input.loc[(input[sic].between(7800,7829)) | (input[sic].between(7830,7833)) | (input[sic].between(7840,7841)) | (input[sic].between(7900,7900)) | (input[sic].between(7910,7911)) | (input[sic].between(7920,7929)) | (input[sic].between(7930,7933)) | (input[sic].between(7940,7949)) | (input[sic].between(7980,7980)) | (input[sic].between(7990,7999)), description] = &#39;Fun    Entertainment&#39;
    input.loc[(input[sic].between(2700,2709)) | (input[sic].between(2710,2719)) | (input[sic].between(2720,2729)) | (input[sic].between(2730,2739)) | (input[sic].between(2740,2749)) | (input[sic].between(2770,2771)) | (input[sic].between(2780,2789)) | (input[sic].between(2790,2799)), code] = 8
    if(description!=None):
        input.loc[(input[sic].between(2700,2709)) | (input[sic].between(2710,2719)) | (input[sic].between(2720,2729)) | (input[sic].between(2730,2739)) | (input[sic].between(2740,2749)) | (input[sic].between(2770,2771)) | (input[sic].between(2780,2789)) | (input[sic].between(2790,2799)), description] = &#39;Books  Printing and Publishing&#39;
    input.loc[(input[sic].between(2047,2047)) | (input[sic].between(2391,2392)) | (input[sic].between(2510,2519)) | (input[sic].between(2590,2599)) | (input[sic].between(2840,2843)) | (input[sic].between(2844,2844)) | (input[sic].between(3160,3161)) | (input[sic].between(3170,3171)) | (input[sic].between(3172,3172)) | (input[sic].between(3190,3199)) | (input[sic].between(3229,3229)) | (input[sic].between(3260,3260)) | (input[sic].between(3262,3263)) | (input[sic].between(3269,3269)) | (input[sic].between(3230,3231)) | (input[sic].between(3630,3639)) | (input[sic].between(3750,3751)) | (input[sic].between(3800,3800)) | (input[sic].between(3860,3861)) | (input[sic].between(3870,3873)) | (input[sic].between(3910,3911)) | (input[sic].between(3914,3914)) | (input[sic].between(3915,3915)) | (input[sic].between(3960,3962)) | (input[sic].between(3991,3991)) | (input[sic].between(3995,3995)), code] = 9
    if(description!=None):
        input.loc[(input[sic].between(2047,2047)) | (input[sic].between(2391,2392)) | (input[sic].between(2510,2519)) | (input[sic].between(2590,2599)) | (input[sic].between(2840,2843)) | (input[sic].between(2844,2844)) | (input[sic].between(3160,3161)) | (input[sic].between(3170,3171)) | (input[sic].between(3172,3172)) | (input[sic].between(3190,3199)) | (input[sic].between(3229,3229)) | (input[sic].between(3260,3260)) | (input[sic].between(3262,3263)) | (input[sic].between(3269,3269)) | (input[sic].between(3230,3231)) | (input[sic].between(3630,3639)) | (input[sic].between(3750,3751)) | (input[sic].between(3800,3800)) | (input[sic].between(3860,3861)) | (input[sic].between(3870,3873)) | (input[sic].between(3910,3911)) | (input[sic].between(3914,3914)) | (input[sic].between(3915,3915)) | (input[sic].between(3960,3962)) | (input[sic].between(3991,3991)) | (input[sic].between(3995,3995)), description] = &#39;Hshld  Consumer Goods&#39;
    input.loc[(input[sic].between(2300,2390)) | (input[sic].between(3020,3021)) | (input[sic].between(3100,3111)) | (input[sic].between(3130,3131)) | (input[sic].between(3140,3149)) | (input[sic].between(3150,3151)) | (input[sic].between(3963,3965)), code] = 10
    if(description!=None):
        input.loc[(input[sic].between(2300,2390)) | (input[sic].between(3020,3021)) | (input[sic].between(3100,3111)) | (input[sic].between(3130,3131)) | (input[sic].between(3140,3149)) | (input[sic].between(3150,3151)) | (input[sic].between(3963,3965)), description] = &#39;Clths  Apparel&#39;
    input.loc[(input[sic].between(8000,8099)), code] = 11
    if(description!=None):
        input.loc[(input[sic].between(8000,8099)), description] = &#39;Hlth   Healthcare&#39;
    input.loc[(input[sic].between(3693,3693)) | (input[sic].between(3840,3849)) | (input[sic].between(3850,3851)), code] = 12
    if(description!=None):
        input.loc[(input[sic].between(3693,3693)) | (input[sic].between(3840,3849)) | (input[sic].between(3850,3851)), description] = &#39;MedEq  Medical Equipment&#39;
    input.loc[(input[sic].between(2830,2830)) | (input[sic].between(2831,2831)) | (input[sic].between(2833,2833)) | (input[sic].between(2834,2834)) | (input[sic].between(2835,2835)) | (input[sic].between(2836,2836)), code] = 13
    if(description!=None):
        input.loc[(input[sic].between(2830,2830)) | (input[sic].between(2831,2831)) | (input[sic].between(2833,2833)) | (input[sic].between(2834,2834)) | (input[sic].between(2835,2835)) | (input[sic].between(2836,2836)), description] = &#39;Drugs  Pharmaceutical Products&#39;
    input.loc[(input[sic].between(2800,2809)) | (input[sic].between(2810,2819)) | (input[sic].between(2820,2829)) | (input[sic].between(2850,2859)) | (input[sic].between(2860,2869)) | (input[sic].between(2870,2879)) | (input[sic].between(2890,2899)), code] = 14
    if(description!=None):
        input.loc[(input[sic].between(2800,2809)) | (input[sic].between(2810,2819)) | (input[sic].between(2820,2829)) | (input[sic].between(2850,2859)) | (input[sic].between(2860,2869)) | (input[sic].between(2870,2879)) | (input[sic].between(2890,2899)), description] = &#39;Chems  Chemicals&#39;
    input.loc[(input[sic].between(3031,3031)) | (input[sic].between(3041,3041)) | (input[sic].between(3050,3053)) | (input[sic].between(3060,3069)) | (input[sic].between(3070,3079)) | (input[sic].between(3080,3089)) | (input[sic].between(3090,3099)), code] = 15
    if(description!=None):
        input.loc[(input[sic].between(3031,3031)) | (input[sic].between(3041,3041)) | (input[sic].between(3050,3053)) | (input[sic].between(3060,3069)) | (input[sic].between(3070,3079)) | (input[sic].between(3080,3089)) | (input[sic].between(3090,3099)), description] = &#39;Rubbr  Rubber and Plastic Products&#39;
    input.loc[(input[sic].between(2200,2269)) | (input[sic].between(2270,2279)) | (input[sic].between(2280,2284)) | (input[sic].between(2290,2295)) | (input[sic].between(2297,2297)) | (input[sic].between(2298,2298)) | (input[sic].between(2299,2299)) | (input[sic].between(2393,2395)) | (input[sic].between(2397,2399)), code] = 16
    if(description!=None):
        input.loc[(input[sic].between(2200,2269)) | (input[sic].between(2270,2279)) | (input[sic].between(2280,2284)) | (input[sic].between(2290,2295)) | (input[sic].between(2297,2297)) | (input[sic].between(2298,2298)) | (input[sic].between(2299,2299)) | (input[sic].between(2393,2395)) | (input[sic].between(2397,2399)), description] = &#39;Txtls  Textiles&#39;
    input.loc[(input[sic].between(800,899)) | (input[sic].between(2400,2439)) | (input[sic].between(2450,2459)) | (input[sic].between(2490,2499)) | (input[sic].between(2660,2661)) | (input[sic].between(2950,2952)) | (input[sic].between(3200,3200)) | (input[sic].between(3210,3211)) | (input[sic].between(3240,3241)) | (input[sic].between(3250,3259)) | (input[sic].between(3261,3261)) | (input[sic].between(3264,3264)) | (input[sic].between(3270,3275)) | (input[sic].between(3280,3281)) | (input[sic].between(3290,3293)) | (input[sic].between(3295,3299)) | (input[sic].between(3420,3429)) | (input[sic].between(3430,3433)) | (input[sic].between(3440,3441)) | (input[sic].between(3442,3442)) | (input[sic].between(3446,3446)) | (input[sic].between(3448,3448)) | (input[sic].between(3449,3449)) | (input[sic].between(3450,3451)) | (input[sic].between(3452,3452)) | (input[sic].between(3490,3499)) | (input[sic].between(3996,3996)), code] = 17
    if(description!=None):
        input.loc[(input[sic].between(800,899)) | (input[sic].between(2400,2439)) | (input[sic].between(2450,2459)) | (input[sic].between(2490,2499)) | (input[sic].between(2660,2661)) | (input[sic].between(2950,2952)) | (input[sic].between(3200,3200)) | (input[sic].between(3210,3211)) | (input[sic].between(3240,3241)) | (input[sic].between(3250,3259)) | (input[sic].between(3261,3261)) | (input[sic].between(3264,3264)) | (input[sic].between(3270,3275)) | (input[sic].between(3280,3281)) | (input[sic].between(3290,3293)) | (input[sic].between(3295,3299)) | (input[sic].between(3420,3429)) | (input[sic].between(3430,3433)) | (input[sic].between(3440,3441)) | (input[sic].between(3442,3442)) | (input[sic].between(3446,3446)) | (input[sic].between(3448,3448)) | (input[sic].between(3449,3449)) | (input[sic].between(3450,3451)) | (input[sic].between(3452,3452)) | (input[sic].between(3490,3499)) | (input[sic].between(3996,3996)), description] = &#39;BldMt  Construction Materials&#39;
    input.loc[(input[sic].between(1500,1511)) | (input[sic].between(1520,1529)) | (input[sic].between(1530,1539)) | (input[sic].between(1540,1549)) | (input[sic].between(1600,1699)) | (input[sic].between(1700,1799)), code] = 18
    if(description!=None):
        input.loc[(input[sic].between(1500,1511)) | (input[sic].between(1520,1529)) | (input[sic].between(1530,1539)) | (input[sic].between(1540,1549)) | (input[sic].between(1600,1699)) | (input[sic].between(1700,1799)), description] = &#39;Cnstr  Construction&#39;
    input.loc[(input[sic].between(3300,3300)) | (input[sic].between(3310,3317)) | (input[sic].between(3320,3325)) | (input[sic].between(3330,3339)) | (input[sic].between(3340,3341)) | (input[sic].between(3350,3357)) | (input[sic].between(3360,3369)) | (input[sic].between(3370,3379)) | (input[sic].between(3390,3399)), code] = 19
    if(description!=None):
        input.loc[(input[sic].between(3300,3300)) | (input[sic].between(3310,3317)) | (input[sic].between(3320,3325)) | (input[sic].between(3330,3339)) | (input[sic].between(3340,3341)) | (input[sic].between(3350,3357)) | (input[sic].between(3360,3369)) | (input[sic].between(3370,3379)) | (input[sic].between(3390,3399)), description] = &#39;Steel  Steel Works Etc&#39;
    input.loc[(input[sic].between(3400,3400)) | (input[sic].between(3443,3443)) | (input[sic].between(3444,3444)) | (input[sic].between(3460,3469)) | (input[sic].between(3470,3479)), code] = 20
    if(description!=None):
        input.loc[(input[sic].between(3400,3400)) | (input[sic].between(3443,3443)) | (input[sic].between(3444,3444)) | (input[sic].between(3460,3469)) | (input[sic].between(3470,3479)), description] = &#39;FabPr  Fabricated Products&#39;
    input.loc[(input[sic].between(3510,3519)) | (input[sic].between(3520,3529)) | (input[sic].between(3530,3530)) | (input[sic].between(3531,3531)) | (input[sic].between(3532,3532)) | (input[sic].between(3533,3533)) | (input[sic].between(3534,3534)) | (input[sic].between(3535,3535)) | (input[sic].between(3536,3536)) | (input[sic].between(3538,3538)) | (input[sic].between(3540,3549)) | (input[sic].between(3550,3559)) | (input[sic].between(3560,3569)) | (input[sic].between(3580,3580)) | (input[sic].between(3581,3581)) | (input[sic].between(3582,3582)) | (input[sic].between(3585,3585)) | (input[sic].between(3586,3586)) | (input[sic].between(3589,3589)) | (input[sic].between(3590,3599)), code] = 21
    if(description!=None):
        input.loc[(input[sic].between(3510,3519)) | (input[sic].between(3520,3529)) | (input[sic].between(3530,3530)) | (input[sic].between(3531,3531)) | (input[sic].between(3532,3532)) | (input[sic].between(3533,3533)) | (input[sic].between(3534,3534)) | (input[sic].between(3535,3535)) | (input[sic].between(3536,3536)) | (input[sic].between(3538,3538)) | (input[sic].between(3540,3549)) | (input[sic].between(3550,3559)) | (input[sic].between(3560,3569)) | (input[sic].between(3580,3580)) | (input[sic].between(3581,3581)) | (input[sic].between(3582,3582)) | (input[sic].between(3585,3585)) | (input[sic].between(3586,3586)) | (input[sic].between(3589,3589)) | (input[sic].between(3590,3599)), description] = &#39;Mach   Machinery&#39;
    input.loc[(input[sic].between(3600,3600)) | (input[sic].between(3610,3613)) | (input[sic].between(3620,3621)) | (input[sic].between(3623,3629)) | (input[sic].between(3640,3644)) | (input[sic].between(3645,3645)) | (input[sic].between(3646,3646)) | (input[sic].between(3648,3649)) | (input[sic].between(3660,3660)) | (input[sic].between(3690,3690)) | (input[sic].between(3691,3692)) | (input[sic].between(3699,3699)), code] = 22
    if(description!=None):
        input.loc[(input[sic].between(3600,3600)) | (input[sic].between(3610,3613)) | (input[sic].between(3620,3621)) | (input[sic].between(3623,3629)) | (input[sic].between(3640,3644)) | (input[sic].between(3645,3645)) | (input[sic].between(3646,3646)) | (input[sic].between(3648,3649)) | (input[sic].between(3660,3660)) | (input[sic].between(3690,3690)) | (input[sic].between(3691,3692)) | (input[sic].between(3699,3699)), description] = &#39;ElcEq  Electrical Equipment&#39;
    input.loc[(input[sic].between(2296,2296)) | (input[sic].between(2396,2396)) | (input[sic].between(3010,3011)) | (input[sic].between(3537,3537)) | (input[sic].between(3647,3647)) | (input[sic].between(3694,3694)) | (input[sic].between(3700,3700)) | (input[sic].between(3710,3710)) | (input[sic].between(3711,3711)) | (input[sic].between(3713,3713)) | (input[sic].between(3714,3714)) | (input[sic].between(3715,3715)) | (input[sic].between(3716,3716)) | (input[sic].between(3792,3792)) | (input[sic].between(3790,3791)) | (input[sic].between(3799,3799)), code] = 23
    if(description!=None):
        input.loc[(input[sic].between(2296,2296)) | (input[sic].between(2396,2396)) | (input[sic].between(3010,3011)) | (input[sic].between(3537,3537)) | (input[sic].between(3647,3647)) | (input[sic].between(3694,3694)) | (input[sic].between(3700,3700)) | (input[sic].between(3710,3710)) | (input[sic].between(3711,3711)) | (input[sic].between(3713,3713)) | (input[sic].between(3714,3714)) | (input[sic].between(3715,3715)) | (input[sic].between(3716,3716)) | (input[sic].between(3792,3792)) | (input[sic].between(3790,3791)) | (input[sic].between(3799,3799)), description] = &#39;Autos  Automobiles and Trucks&#39;
    input.loc[(input[sic].between(3720,3720)) | (input[sic].between(3721,3721)) | (input[sic].between(3723,3724)) | (input[sic].between(3725,3725)) | (input[sic].between(3728,3729)), code] = 24
    if(description!=None):
        input.loc[(input[sic].between(3720,3720)) | (input[sic].between(3721,3721)) | (input[sic].between(3723,3724)) | (input[sic].between(3725,3725)) | (input[sic].between(3728,3729)), description] = &#39;Aero   Aircraft&#39;
    input.loc[(input[sic].between(3730,3731)) | (input[sic].between(3740,3743)), code] = 25
    if(description!=None):
        input.loc[(input[sic].between(3730,3731)) | (input[sic].between(3740,3743)), description] = &#39;Ships  Shipbuilding, Railroad Equipment&#39;
    input.loc[(input[sic].between(3760,3769)) | (input[sic].between(3795,3795)) | (input[sic].between(3480,3489)), code] = 26
    if(description!=None):
        input.loc[(input[sic].between(3760,3769)) | (input[sic].between(3795,3795)) | (input[sic].between(3480,3489)), description] = &#39;Guns   Defense&#39;
    input.loc[(input[sic].between(1040,1049)), code] = 27
    if(description!=None):
        input.loc[(input[sic].between(1040,1049)), description] = &#39;Gold   Precious Metals&#39;
    input.loc[(input[sic].between(1000,1009)) | (input[sic].between(1010,1019)) | (input[sic].between(1020,1029)) | (input[sic].between(1030,1039)) | (input[sic].between(1050,1059)) | (input[sic].between(1060,1069)) | (input[sic].between(1070,1079)) | (input[sic].between(1080,1089)) | (input[sic].between(1090,1099)) | (input[sic].between(1100,1119)) | (input[sic].between(1400,1499)), code] = 28
    if(description!=None):
        input.loc[(input[sic].between(1000,1009)) | (input[sic].between(1010,1019)) | (input[sic].between(1020,1029)) | (input[sic].between(1030,1039)) | (input[sic].between(1050,1059)) | (input[sic].between(1060,1069)) | (input[sic].between(1070,1079)) | (input[sic].between(1080,1089)) | (input[sic].between(1090,1099)) | (input[sic].between(1100,1119)) | (input[sic].between(1400,1499)), description] = &#39;Mines  Non-Metallic and Industrial Metal Mining&#39;
    input.loc[(input[sic].between(1200,1299)), code] = 29
    if(description!=None):
        input.loc[(input[sic].between(1200,1299)), description] = &#39;Coal   Coal&#39;
    input.loc[(input[sic].between(1300,1300)) | (input[sic].between(1310,1319)) | (input[sic].between(1320,1329)) | (input[sic].between(1330,1339)) | (input[sic].between(1370,1379)) | (input[sic].between(1380,1380)) | (input[sic].between(1381,1381)) | (input[sic].between(1382,1382)) | (input[sic].between(1389,1389)) | (input[sic].between(2900,2912)) | (input[sic].between(2990,2999)), code] = 30
    if(description!=None):
        input.loc[(input[sic].between(1300,1300)) | (input[sic].between(1310,1319)) | (input[sic].between(1320,1329)) | (input[sic].between(1330,1339)) | (input[sic].between(1370,1379)) | (input[sic].between(1380,1380)) | (input[sic].between(1381,1381)) | (input[sic].between(1382,1382)) | (input[sic].between(1389,1389)) | (input[sic].between(2900,2912)) | (input[sic].between(2990,2999)), description] = &#39;Oil    Petroleum and Natural Gas&#39;
    input.loc[(input[sic].between(4900,4900)) | (input[sic].between(4910,4911)) | (input[sic].between(4920,4922)) | (input[sic].between(4923,4923)) | (input[sic].between(4924,4925)) | (input[sic].between(4930,4931)) | (input[sic].between(4932,4932)) | (input[sic].between(4939,4939)) | (input[sic].between(4940,4942)), code] = 31
    if(description!=None):
        input.loc[(input[sic].between(4900,4900)) | (input[sic].between(4910,4911)) | (input[sic].between(4920,4922)) | (input[sic].between(4923,4923)) | (input[sic].between(4924,4925)) | (input[sic].between(4930,4931)) | (input[sic].between(4932,4932)) | (input[sic].between(4939,4939)) | (input[sic].between(4940,4942)), description] = &#39;Util   Utilities&#39;
    input.loc[(input[sic].between(4800,4800)) | (input[sic].between(4810,4813)) | (input[sic].between(4820,4822)) | (input[sic].between(4830,4839)) | (input[sic].between(4840,4841)) | (input[sic].between(4880,4889)) | (input[sic].between(4890,4890)) | (input[sic].between(4891,4891)) | (input[sic].between(4892,4892)) | (input[sic].between(4899,4899)), code] = 32
    if(description!=None):
        input.loc[(input[sic].between(4800,4800)) | (input[sic].between(4810,4813)) | (input[sic].between(4820,4822)) | (input[sic].between(4830,4839)) | (input[sic].between(4840,4841)) | (input[sic].between(4880,4889)) | (input[sic].between(4890,4890)) | (input[sic].between(4891,4891)) | (input[sic].between(4892,4892)) | (input[sic].between(4899,4899)), description] = &#39;Telcm  Communication&#39;
    input.loc[(input[sic].between(7020,7021)) | (input[sic].between(7030,7033)) | (input[sic].between(7200,7200)) | (input[sic].between(7210,7212)) | (input[sic].between(7214,7214)) | (input[sic].between(7215,7216)) | (input[sic].between(7217,7217)) | (input[sic].between(7219,7219)) | (input[sic].between(7220,7221)) | (input[sic].between(7230,7231)) | (input[sic].between(7240,7241)) | (input[sic].between(7250,7251)) | (input[sic].between(7260,7269)) | (input[sic].between(7270,7290)) | (input[sic].between(7291,7291)) | (input[sic].between(7292,7299)) | (input[sic].between(7395,7395)) | (input[sic].between(7500,7500)) | (input[sic].between(7520,7529)) | (input[sic].between(7530,7539)) | (input[sic].between(7540,7549)) | (input[sic].between(7600,7600)) | (input[sic].between(7620,7620)) | (input[sic].between(7622,7622)) | (input[sic].between(7623,7623)) | (input[sic].between(7629,7629)) | (input[sic].between(7630,7631)) | (input[sic].between(7640,7641)) | (input[sic].between(7690,7699)) | (input[sic].between(8100,8199)) | (input[sic].between(8200,8299)) | (input[sic].between(8300,8399)) | (input[sic].between(8400,8499)) | (input[sic].between(8600,8699)) | (input[sic].between(8800,8899)) | (input[sic].between(7510,7515)), code] = 33
    if(description!=None):
        input.loc[(input[sic].between(7020,7021)) | (input[sic].between(7030,7033)) | (input[sic].between(7200,7200)) | (input[sic].between(7210,7212)) | (input[sic].between(7214,7214)) | (input[sic].between(7215,7216)) | (input[sic].between(7217,7217)) | (input[sic].between(7219,7219)) | (input[sic].between(7220,7221)) | (input[sic].between(7230,7231)) | (input[sic].between(7240,7241)) | (input[sic].between(7250,7251)) | (input[sic].between(7260,7269)) | (input[sic].between(7270,7290)) | (input[sic].between(7291,7291)) | (input[sic].between(7292,7299)) | (input[sic].between(7395,7395)) | (input[sic].between(7500,7500)) | (input[sic].between(7520,7529)) | (input[sic].between(7530,7539)) | (input[sic].between(7540,7549)) | (input[sic].between(7600,7600)) | (input[sic].between(7620,7620)) | (input[sic].between(7622,7622)) | (input[sic].between(7623,7623)) | (input[sic].between(7629,7629)) | (input[sic].between(7630,7631)) | (input[sic].between(7640,7641)) | (input[sic].between(7690,7699)) | (input[sic].between(8100,8199)) | (input[sic].between(8200,8299)) | (input[sic].between(8300,8399)) | (input[sic].between(8400,8499)) | (input[sic].between(8600,8699)) | (input[sic].between(8800,8899)) | (input[sic].between(7510,7515)), description] = &#39;PerSv  Personal Services&#39;
    input.loc[(input[sic].between(2750,2759)) | (input[sic].between(3993,3993)) | (input[sic].between(7218,7218)) | (input[sic].between(7300,7300)) | (input[sic].between(7310,7319)) | (input[sic].between(7320,7329)) | (input[sic].between(7330,7339)) | (input[sic].between(7340,7342)) | (input[sic].between(7349,7349)) | (input[sic].between(7350,7351)) | (input[sic].between(7352,7352)) | (input[sic].between(7353,7353)) | (input[sic].between(7359,7359)) | (input[sic].between(7360,7369)) | (input[sic].between(7370,7372)) | (input[sic].between(7374,7374)) | (input[sic].between(7375,7375)) | (input[sic].between(7376,7376)) | (input[sic].between(7377,7377)) | (input[sic].between(7378,7378)) | (input[sic].between(7379,7379)) | (input[sic].between(7380,7380)) | (input[sic].between(7381,7382)) | (input[sic].between(7383,7383)) | (input[sic].between(7384,7384)) | (input[sic].between(7385,7385)) | (input[sic].between(7389,7390)) | (input[sic].between(7391,7391)) | (input[sic].between(7392,7392)) | (input[sic].between(7393,7393)) | (input[sic].between(7394,7394)) | (input[sic].between(7396,7396)) | (input[sic].between(7397,7397)) | (input[sic].between(7399,7399)) | (input[sic].between(7519,7519)) | (input[sic].between(8700,8700)) | (input[sic].between(8710,8713)) | (input[sic].between(8720,8721)) | (input[sic].between(8730,8734)) | (input[sic].between(8740,8748)) | (input[sic].between(8900,8910)) | (input[sic].between(8911,8911)) | (input[sic].between(8920,8999)) | (input[sic].between(4220,4229)), code] = 34
    if(description!=None):
        input.loc[(input[sic].between(2750,2759)) | (input[sic].between(3993,3993)) | (input[sic].between(7218,7218)) | (input[sic].between(7300,7300)) | (input[sic].between(7310,7319)) | (input[sic].between(7320,7329)) | (input[sic].between(7330,7339)) | (input[sic].between(7340,7342)) | (input[sic].between(7349,7349)) | (input[sic].between(7350,7351)) | (input[sic].between(7352,7352)) | (input[sic].between(7353,7353)) | (input[sic].between(7359,7359)) | (input[sic].between(7360,7369)) | (input[sic].between(7370,7372)) | (input[sic].between(7374,7374)) | (input[sic].between(7375,7375)) | (input[sic].between(7376,7376)) | (input[sic].between(7377,7377)) | (input[sic].between(7378,7378)) | (input[sic].between(7379,7379)) | (input[sic].between(7380,7380)) | (input[sic].between(7381,7382)) | (input[sic].between(7383,7383)) | (input[sic].between(7384,7384)) | (input[sic].between(7385,7385)) | (input[sic].between(7389,7390)) | (input[sic].between(7391,7391)) | (input[sic].between(7392,7392)) | (input[sic].between(7393,7393)) | (input[sic].between(7394,7394)) | (input[sic].between(7396,7396)) | (input[sic].between(7397,7397)) | (input[sic].between(7399,7399)) | (input[sic].between(7519,7519)) | (input[sic].between(8700,8700)) | (input[sic].between(8710,8713)) | (input[sic].between(8720,8721)) | (input[sic].between(8730,8734)) | (input[sic].between(8740,8748)) | (input[sic].between(8900,8910)) | (input[sic].between(8911,8911)) | (input[sic].between(8920,8999)) | (input[sic].between(4220,4229)), description] = &#39;BusSv  Business Services&#39;
    input.loc[(input[sic].between(3570,3579)) | (input[sic].between(3680,3680)) | (input[sic].between(3681,3681)) | (input[sic].between(3682,3682)) | (input[sic].between(3683,3683)) | (input[sic].between(3684,3684)) | (input[sic].between(3685,3685)) | (input[sic].between(3686,3686)) | (input[sic].between(3687,3687)) | (input[sic].between(3688,3688)) | (input[sic].between(3689,3689)) | (input[sic].between(3695,3695)) | (input[sic].between(7373,7373)), code] = 35
    if(description!=None):
        input.loc[(input[sic].between(3570,3579)) | (input[sic].between(3680,3680)) | (input[sic].between(3681,3681)) | (input[sic].between(3682,3682)) | (input[sic].between(3683,3683)) | (input[sic].between(3684,3684)) | (input[sic].between(3685,3685)) | (input[sic].between(3686,3686)) | (input[sic].between(3687,3687)) | (input[sic].between(3688,3688)) | (input[sic].between(3689,3689)) | (input[sic].between(3695,3695)) | (input[sic].between(7373,7373)), description] = &#39;Comps  Computers&#39;
    input.loc[(input[sic].between(3622,3622)) | (input[sic].between(3661,3661)) | (input[sic].between(3662,3662)) | (input[sic].between(3663,3663)) | (input[sic].between(3664,3664)) | (input[sic].between(3665,3665)) | (input[sic].between(3666,3666)) | (input[sic].between(3669,3669)) | (input[sic].between(3670,3679)) | (input[sic].between(3810,3810)) | (input[sic].between(3812,3812)), code] = 36
    if(description!=None):
        input.loc[(input[sic].between(3622,3622)) | (input[sic].between(3661,3661)) | (input[sic].between(3662,3662)) | (input[sic].between(3663,3663)) | (input[sic].between(3664,3664)) | (input[sic].between(3665,3665)) | (input[sic].between(3666,3666)) | (input[sic].between(3669,3669)) | (input[sic].between(3670,3679)) | (input[sic].between(3810,3810)) | (input[sic].between(3812,3812)), description] = &#39;Chips  Electronic Equipment&#39;
    input.loc[(input[sic].between(3811,3811)) | (input[sic].between(3820,3820)) | (input[sic].between(3821,3821)) | (input[sic].between(3822,3822)) | (input[sic].between(3823,3823)) | (input[sic].between(3824,3824)) | (input[sic].between(3825,3825)) | (input[sic].between(3826,3826)) | (input[sic].between(3827,3827)) | (input[sic].between(3829,3829)) | (input[sic].between(3830,3839)), code] = 37
    if(description!=None):
        input.loc[(input[sic].between(3811,3811)) | (input[sic].between(3820,3820)) | (input[sic].between(3821,3821)) | (input[sic].between(3822,3822)) | (input[sic].between(3823,3823)) | (input[sic].between(3824,3824)) | (input[sic].between(3825,3825)) | (input[sic].between(3826,3826)) | (input[sic].between(3827,3827)) | (input[sic].between(3829,3829)) | (input[sic].between(3830,3839)), description] = &#39;LabEq  Measuring and Control Equipment&#39;
    input.loc[(input[sic].between(2520,2549)) | (input[sic].between(2600,2639)) | (input[sic].between(2670,2699)) | (input[sic].between(2760,2761)) | (input[sic].between(3950,3955)), code] = 38
    if(description!=None):
        input.loc[(input[sic].between(2520,2549)) | (input[sic].between(2600,2639)) | (input[sic].between(2670,2699)) | (input[sic].between(2760,2761)) | (input[sic].between(3950,3955)), description] = &#39;Paper  Business Supplies&#39;
    input.loc[(input[sic].between(2440,2449)) | (input[sic].between(2640,2659)) | (input[sic].between(3220,3221)) | (input[sic].between(3410,3412)), code] = 39
    if(description!=None):
        input.loc[(input[sic].between(2440,2449)) | (input[sic].between(2640,2659)) | (input[sic].between(3220,3221)) | (input[sic].between(3410,3412)), description] = &#39;Boxes  Shipping Containers&#39;
    input.loc[(input[sic].between(4000,4013)) | (input[sic].between(4040,4049)) | (input[sic].between(4100,4100)) | (input[sic].between(4110,4119)) | (input[sic].between(4120,4121)) | (input[sic].between(4130,4131)) | (input[sic].between(4140,4142)) | (input[sic].between(4150,4151)) | (input[sic].between(4170,4173)) | (input[sic].between(4190,4199)) | (input[sic].between(4200,4200)) | (input[sic].between(4210,4219)) | (input[sic].between(4230,4231)) | (input[sic].between(4240,4249)) | (input[sic].between(4400,4499)) | (input[sic].between(4500,4599)) | (input[sic].between(4600,4699)) | (input[sic].between(4700,4700)) | (input[sic].between(4710,4712)) | (input[sic].between(4720,4729)) | (input[sic].between(4730,4739)) | (input[sic].between(4740,4749)) | (input[sic].between(4780,4780)) | (input[sic].between(4782,4782)) | (input[sic].between(4783,4783)) | (input[sic].between(4784,4784)) | (input[sic].between(4785,4785)) | (input[sic].between(4789,4789)), code] = 40
    if(description!=None):
        input.loc[(input[sic].between(4000,4013)) | (input[sic].between(4040,4049)) | (input[sic].between(4100,4100)) | (input[sic].between(4110,4119)) | (input[sic].between(4120,4121)) | (input[sic].between(4130,4131)) | (input[sic].between(4140,4142)) | (input[sic].between(4150,4151)) | (input[sic].between(4170,4173)) | (input[sic].between(4190,4199)) | (input[sic].between(4200,4200)) | (input[sic].between(4210,4219)) | (input[sic].between(4230,4231)) | (input[sic].between(4240,4249)) | (input[sic].between(4400,4499)) | (input[sic].between(4500,4599)) | (input[sic].between(4600,4699)) | (input[sic].between(4700,4700)) | (input[sic].between(4710,4712)) | (input[sic].between(4720,4729)) | (input[sic].between(4730,4739)) | (input[sic].between(4740,4749)) | (input[sic].between(4780,4780)) | (input[sic].between(4782,4782)) | (input[sic].between(4783,4783)) | (input[sic].between(4784,4784)) | (input[sic].between(4785,4785)) | (input[sic].between(4789,4789)), description] = &#39;Trans  Transportation&#39;
    input.loc[(input[sic].between(5000,5000)) | (input[sic].between(5010,5015)) | (input[sic].between(5020,5023)) | (input[sic].between(5030,5039)) | (input[sic].between(5040,5042)) | (input[sic].between(5043,5043)) | (input[sic].between(5044,5044)) | (input[sic].between(5045,5045)) | (input[sic].between(5046,5046)) | (input[sic].between(5047,5047)) | (input[sic].between(5048,5048)) | (input[sic].between(5049,5049)) | (input[sic].between(5050,5059)) | (input[sic].between(5060,5060)) | (input[sic].between(5063,5063)) | (input[sic].between(5064,5064)) | (input[sic].between(5065,5065)) | (input[sic].between(5070,5078)) | (input[sic].between(5080,5080)) | (input[sic].between(5081,5081)) | (input[sic].between(5082,5082)) | (input[sic].between(5083,5083)) | (input[sic].between(5084,5084)) | (input[sic].between(5085,5085)) | (input[sic].between(5086,5087)) | (input[sic].between(5088,5088)) | (input[sic].between(5090,5090)) | (input[sic].between(5091,5092)) | (input[sic].between(5093,5093)) | (input[sic].between(5094,5094)) | (input[sic].between(5099,5099)) | (input[sic].between(5100,5100)) | (input[sic].between(5110,5113)) | (input[sic].between(5120,5122)) | (input[sic].between(5130,5139)) | (input[sic].between(5140,5149)) | (input[sic].between(5150,5159)) | (input[sic].between(5160,5169)) | (input[sic].between(5170,5172)) | (input[sic].between(5180,5182)) | (input[sic].between(5190,5199)), code] = 41
    if(description!=None):
        input.loc[(input[sic].between(5000,5000)) | (input[sic].between(5010,5015)) | (input[sic].between(5020,5023)) | (input[sic].between(5030,5039)) | (input[sic].between(5040,5042)) | (input[sic].between(5043,5043)) | (input[sic].between(5044,5044)) | (input[sic].between(5045,5045)) | (input[sic].between(5046,5046)) | (input[sic].between(5047,5047)) | (input[sic].between(5048,5048)) | (input[sic].between(5049,5049)) | (input[sic].between(5050,5059)) | (input[sic].between(5060,5060)) | (input[sic].between(5063,5063)) | (input[sic].between(5064,5064)) | (input[sic].between(5065,5065)) | (input[sic].between(5070,5078)) | (input[sic].between(5080,5080)) | (input[sic].between(5081,5081)) | (input[sic].between(5082,5082)) | (input[sic].between(5083,5083)) | (input[sic].between(5084,5084)) | (input[sic].between(5085,5085)) | (input[sic].between(5086,5087)) | (input[sic].between(5088,5088)) | (input[sic].between(5090,5090)) | (input[sic].between(5091,5092)) | (input[sic].between(5093,5093)) | (input[sic].between(5094,5094)) | (input[sic].between(5099,5099)) | (input[sic].between(5100,5100)) | (input[sic].between(5110,5113)) | (input[sic].between(5120,5122)) | (input[sic].between(5130,5139)) | (input[sic].between(5140,5149)) | (input[sic].between(5150,5159)) | (input[sic].between(5160,5169)) | (input[sic].between(5170,5172)) | (input[sic].between(5180,5182)) | (input[sic].between(5190,5199)), description] = &#39;Whlsl  Wholesale&#39;
    input.loc[(input[sic].between(5200,5200)) | (input[sic].between(5210,5219)) | (input[sic].between(5220,5229)) | (input[sic].between(5230,5231)) | (input[sic].between(5250,5251)) | (input[sic].between(5260,5261)) | (input[sic].between(5270,5271)) | (input[sic].between(5300,5300)) | (input[sic].between(5310,5311)) | (input[sic].between(5320,5320)) | (input[sic].between(5330,5331)) | (input[sic].between(5334,5334)) | (input[sic].between(5340,5349)) | (input[sic].between(5390,5399)) | (input[sic].between(5400,5400)) | (input[sic].between(5410,5411)) | (input[sic].between(5412,5412)) | (input[sic].between(5420,5429)) | (input[sic].between(5430,5439)) | (input[sic].between(5440,5449)) | (input[sic].between(5450,5459)) | (input[sic].between(5460,5469)) | (input[sic].between(5490,5499)) | (input[sic].between(5500,5500)) | (input[sic].between(5510,5529)) | (input[sic].between(5530,5539)) | (input[sic].between(5540,5549)) | (input[sic].between(5550,5559)) | (input[sic].between(5560,5569)) | (input[sic].between(5570,5579)) | (input[sic].between(5590,5599)) | (input[sic].between(5600,5699)) | (input[sic].between(5700,5700)) | (input[sic].between(5710,5719)) | (input[sic].between(5720,5722)) | (input[sic].between(5730,5733)) | (input[sic].between(5734,5734)) | (input[sic].between(5735,5735)) | (input[sic].between(5736,5736)) | (input[sic].between(5750,5799)) | (input[sic].between(5900,5900)) | (input[sic].between(5910,5912)) | (input[sic].between(5920,5929)) | (input[sic].between(5930,5932)) | (input[sic].between(5940,5940)) | (input[sic].between(5941,5941)) | (input[sic].between(5942,5942)) | (input[sic].between(5943,5943)) | (input[sic].between(5944,5944)) | (input[sic].between(5945,5945)) | (input[sic].between(5946,5946)) | (input[sic].between(5947,5947)) | (input[sic].between(5948,5948)) | (input[sic].between(5949,5949)) | (input[sic].between(5950,5959)) | (input[sic].between(5960,5969)) | (input[sic].between(5970,5979)) | (input[sic].between(5980,5989)) | (input[sic].between(5990,5990)) | (input[sic].between(5992,5992)) | (input[sic].between(5993,5993)) | (input[sic].between(5994,5994)) | (input[sic].between(5995,5995)) | (input[sic].between(5999,5999)), code] = 42
    if(description!=None):
        input.loc[(input[sic].between(5200,5200)) | (input[sic].between(5210,5219)) | (input[sic].between(5220,5229)) | (input[sic].between(5230,5231)) | (input[sic].between(5250,5251)) | (input[sic].between(5260,5261)) | (input[sic].between(5270,5271)) | (input[sic].between(5300,5300)) | (input[sic].between(5310,5311)) | (input[sic].between(5320,5320)) | (input[sic].between(5330,5331)) | (input[sic].between(5334,5334)) | (input[sic].between(5340,5349)) | (input[sic].between(5390,5399)) | (input[sic].between(5400,5400)) | (input[sic].between(5410,5411)) | (input[sic].between(5412,5412)) | (input[sic].between(5420,5429)) | (input[sic].between(5430,5439)) | (input[sic].between(5440,5449)) | (input[sic].between(5450,5459)) | (input[sic].between(5460,5469)) | (input[sic].between(5490,5499)) | (input[sic].between(5500,5500)) | (input[sic].between(5510,5529)) | (input[sic].between(5530,5539)) | (input[sic].between(5540,5549)) | (input[sic].between(5550,5559)) | (input[sic].between(5560,5569)) | (input[sic].between(5570,5579)) | (input[sic].between(5590,5599)) | (input[sic].between(5600,5699)) | (input[sic].between(5700,5700)) | (input[sic].between(5710,5719)) | (input[sic].between(5720,5722)) | (input[sic].between(5730,5733)) | (input[sic].between(5734,5734)) | (input[sic].between(5735,5735)) | (input[sic].between(5736,5736)) | (input[sic].between(5750,5799)) | (input[sic].between(5900,5900)) | (input[sic].between(5910,5912)) | (input[sic].between(5920,5929)) | (input[sic].between(5930,5932)) | (input[sic].between(5940,5940)) | (input[sic].between(5941,5941)) | (input[sic].between(5942,5942)) | (input[sic].between(5943,5943)) | (input[sic].between(5944,5944)) | (input[sic].between(5945,5945)) | (input[sic].between(5946,5946)) | (input[sic].between(5947,5947)) | (input[sic].between(5948,5948)) | (input[sic].between(5949,5949)) | (input[sic].between(5950,5959)) | (input[sic].between(5960,5969)) | (input[sic].between(5970,5979)) | (input[sic].between(5980,5989)) | (input[sic].between(5990,5990)) | (input[sic].between(5992,5992)) | (input[sic].between(5993,5993)) | (input[sic].between(5994,5994)) | (input[sic].between(5995,5995)) | (input[sic].between(5999,5999)), description] = &#39;Rtail  Retail&#39;
    input.loc[(input[sic].between(5800,5819)) | (input[sic].between(5820,5829)) | (input[sic].between(5890,5899)) | (input[sic].between(7000,7000)) | (input[sic].between(7010,7019)) | (input[sic].between(7040,7049)) | (input[sic].between(7213,7213)), code] = 43
    if(description!=None):
        input.loc[(input[sic].between(5800,5819)) | (input[sic].between(5820,5829)) | (input[sic].between(5890,5899)) | (input[sic].between(7000,7000)) | (input[sic].between(7010,7019)) | (input[sic].between(7040,7049)) | (input[sic].between(7213,7213)), description] = &#39;Meals  Restaurants, Hotels, Motels&#39;
    input.loc[(input[sic].between(6000,6000)) | (input[sic].between(6010,6019)) | (input[sic].between(6020,6020)) | (input[sic].between(6021,6021)) | (input[sic].between(6022,6022)) | (input[sic].between(6023,6024)) | (input[sic].between(6025,6025)) | (input[sic].between(6026,6026)) | (input[sic].between(6027,6027)) | (input[sic].between(6028,6029)) | (input[sic].between(6030,6036)) | (input[sic].between(6040,6059)) | (input[sic].between(6060,6062)) | (input[sic].between(6080,6082)) | (input[sic].between(6090,6099)) | (input[sic].between(6100,6100)) | (input[sic].between(6110,6111)) | (input[sic].between(6112,6113)) | (input[sic].between(6120,6129)) | (input[sic].between(6130,6139)) | (input[sic].between(6140,6149)) | (input[sic].between(6150,6159)) | (input[sic].between(6160,6169)) | (input[sic].between(6170,6179)) | (input[sic].between(6190,6199)), code] = 44
    if(description!=None):
        input.loc[(input[sic].between(6000,6000)) | (input[sic].between(6010,6019)) | (input[sic].between(6020,6020)) | (input[sic].between(6021,6021)) | (input[sic].between(6022,6022)) | (input[sic].between(6023,6024)) | (input[sic].between(6025,6025)) | (input[sic].between(6026,6026)) | (input[sic].between(6027,6027)) | (input[sic].between(6028,6029)) | (input[sic].between(6030,6036)) | (input[sic].between(6040,6059)) | (input[sic].between(6060,6062)) | (input[sic].between(6080,6082)) | (input[sic].between(6090,6099)) | (input[sic].between(6100,6100)) | (input[sic].between(6110,6111)) | (input[sic].between(6112,6113)) | (input[sic].between(6120,6129)) | (input[sic].between(6130,6139)) | (input[sic].between(6140,6149)) | (input[sic].between(6150,6159)) | (input[sic].between(6160,6169)) | (input[sic].between(6170,6179)) | (input[sic].between(6190,6199)), description] = &#39;Banks  Banking&#39;
    input.loc[(input[sic].between(6300,6300)) | (input[sic].between(6310,6319)) | (input[sic].between(6320,6329)) | (input[sic].between(6330,6331)) | (input[sic].between(6350,6351)) | (input[sic].between(6360,6361)) | (input[sic].between(6370,6379)) | (input[sic].between(6390,6399)) | (input[sic].between(6400,6411)), code] = 45
    if(description!=None):
        input.loc[(input[sic].between(6300,6300)) | (input[sic].between(6310,6319)) | (input[sic].between(6320,6329)) | (input[sic].between(6330,6331)) | (input[sic].between(6350,6351)) | (input[sic].between(6360,6361)) | (input[sic].between(6370,6379)) | (input[sic].between(6390,6399)) | (input[sic].between(6400,6411)), description] = &#39;Insur  Insurance&#39;
    input.loc[(input[sic].between(6500,6500)) | (input[sic].between(6510,6510)) | (input[sic].between(6512,6512)) | (input[sic].between(6513,6513)) | (input[sic].between(6514,6514)) | (input[sic].between(6515,6515)) | (input[sic].between(6517,6519)) | (input[sic].between(6520,6529)) | (input[sic].between(6530,6531)) | (input[sic].between(6532,6532)) | (input[sic].between(6540,6541)) | (input[sic].between(6550,6553)) | (input[sic].between(6590,6599)) | (input[sic].between(6610,6611)), code] = 46
    if(description!=None):
        input.loc[(input[sic].between(6500,6500)) | (input[sic].between(6510,6510)) | (input[sic].between(6512,6512)) | (input[sic].between(6513,6513)) | (input[sic].between(6514,6514)) | (input[sic].between(6515,6515)) | (input[sic].between(6517,6519)) | (input[sic].between(6520,6529)) | (input[sic].between(6530,6531)) | (input[sic].between(6532,6532)) | (input[sic].between(6540,6541)) | (input[sic].between(6550,6553)) | (input[sic].between(6590,6599)) | (input[sic].between(6610,6611)), description] = &#39;RlEst  Real Estate&#39;
    input.loc[(input[sic].between(6200,6299)) | (input[sic].between(6700,6700)) | (input[sic].between(6710,6719)) | (input[sic].between(6720,6722)) | (input[sic].between(6723,6723)) | (input[sic].between(6724,6724)) | (input[sic].between(6725,6725)) | (input[sic].between(6726,6726)) | (input[sic].between(6730,6733)) | (input[sic].between(6740,6779)) | (input[sic].between(6790,6791)) | (input[sic].between(6792,6792)) | (input[sic].between(6793,6793)) | (input[sic].between(6794,6794)) | (input[sic].between(6795,6795)) | (input[sic].between(6798,6798)) | (input[sic].between(6799,6799)), code] = 47
    if(description!=None):
        input.loc[(input[sic].between(6200,6299)) | (input[sic].between(6700,6700)) | (input[sic].between(6710,6719)) | (input[sic].between(6720,6722)) | (input[sic].between(6723,6723)) | (input[sic].between(6724,6724)) | (input[sic].between(6725,6725)) | (input[sic].between(6726,6726)) | (input[sic].between(6730,6733)) | (input[sic].between(6740,6779)) | (input[sic].between(6790,6791)) | (input[sic].between(6792,6792)) | (input[sic].between(6793,6793)) | (input[sic].between(6794,6794)) | (input[sic].between(6795,6795)) | (input[sic].between(6798,6798)) | (input[sic].between(6799,6799)), description] = &#39;Fin    Trading&#39;
    input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), code] = 48
    if(description!=None):
        input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), description] = &#39;Other  Almost Nothing&#39;
    return input



def show_sas_columns(file_path: str, keys: list = None, charset:str = &#39;utf-8&#39;): 
    &#39;&#39;&#39;
    Show the information for SAS file columns.

    Parameters
    ----------
    file_path : str
        SAS file path.
    keys : list, optional
        The list of column names. If None, all columns&#39; information will be returned. The default is None.
    charset : str, optional
        The charset of the SAS file. The default is &#39;utf-8&#39;.


    &#39;&#39;&#39;
    with pd.option_context(&#39;display.max_rows&#39;, None, &#39;display.max_columns&#39;, None):
        print(read_sas(file_path, keys = keys, chunksize = 1, charset = charset, batch = 0, progress=False).dtypes)


def get_sas_columns(file_path: str, keys: list = None, charset:str = &#39;utf-8&#39;): 
    &#39;&#39;&#39;
    Get the information for SAS file columns.

    Parameters
    ----------
    file_path : str
        SAS file path.
    keys : list, optional
        The list of column names. If None, all columns&#39; information will be returned. The default is None.
    charset : str, optional
        The charset of the SAS file. The default is &#39;utf-8&#39;.

    Returns
    -------
    TYPE
        The names and types of columns specified by &#39;keys&#39;.

    &#39;&#39;&#39;
    return read_sas(file_path, keys = keys, chunksize = 1, charset = charset, batch = 0, progress=False).dtypes

def read_sas(file_path: str, keys: list = None, chunksize:int = 10000, charset:str = &#39;utf-8&#39;, batch:int = None, progress:bool = True):
    &#39;&#39;&#39;
    Read sas file into a data frame.    

    Parameters
    ----------
    file_path : str
        SAS file path.
    keys : list, optional
        The list of column names. If None, all columns&#39; information will be returned. The default is None.
    chunksize : int, optional
        The number of rows read each time. Lowering this value may solve the out of memory problem while loading SAS dataset. The default is 10000.
    charset : str, optional
        The charset of the SAS file. The default is &#39;utf-8&#39;.
    batch : int, optional
        The number of times of reading the database by &#39;chunksize&#39; rows. If it is None, all file will be read. The default is None.
    progress : bool, optional
        Whether shows the loading progress. The default is True.

    Returns
    -------
    Read dataframe.

    &#39;&#39;&#39;    
    
    
    data = pd.DataFrame()
    for df in pd.read_sas(file_path, chunksize=chunksize):
        if(keys==None):
            data = data.append(df)
        else:
            data = data.append(df[keys])
        if(progress):
            print(&#39;.&#39;, sep=&#39; &#39;, end=&#39;&#39;, flush=True)
        if(batch!=None):
            if(batch&gt;0):
                batch-=1
            else:
                break
    for c in data.select_dtypes(include=[&#39;object&#39;]).columns:
        data[c] = data[c].str.decode(charset)
    return data

def add_permno(input: pd.DataFrame , ccmxpf_lnkhist: pd.DataFrame ):
    &#39;&#39;&#39;
    Add PERMNO column to CompuStat dataset. 
    

    Parameters
    ----------
    input : pd.DataFrame
        CompuStat dataset. It must contain &#39;gvkey&#39; and &#39;datadate&#39; columns.
    ccmxpf_lnkhist : pd.DataFrame
        ccmxpf_lnkhist dataset from CRSP.

    Returns
    -------
    input : TYPE
        CompuStat dataset with PERMNO column.

    &#39;&#39;&#39;   
    
        
    link = ccmxpf_lnkhist[ccmxpf_lnkhist.LINKTYPE.isin([&#34;LC&#34;,&#34;LS&#34;,&#34;LU&#34;]) &amp; ccmxpf_lnkhist.LINKPRIM.isin([&#39;P&#39;,&#39;C&#39;])]
    input = sqldf(&#34;select distinct input.*, link.LPERMNO as PERMNO from input, link where input.gvkey=link.gvkey and (input.datadate&gt;=link.LINKDT or link.LINKDT==NULL) and (input.datadate&lt;=link.LINKENDDT or link.LINKENDDT==NULL);&#34;, locals())
    return input


def get_comp(input: pd.DataFrame):
    &#39;&#39;&#39;
    Filter Original CompuStat dataset as WRDS default.

    Parameters
    ----------
    input : pd.DataFrame
        Compustat dataset. It must contains &#39;datafmt&#39;, &#39;indfmt&#39;, &#39;consol&#39;, and &#39;popsrc&#39; columns.

    Returns
    -------
    TYPE
        Filtered Compustat dataset.

    &#39;&#39;&#39;
    
    
    return input[(input[&#39;datafmt&#39;]==&#39;STD&#39;) &amp; (input[&#39;indfmt&#39;]==&#39;INDL&#39;) &amp; (input[&#39;consol&#39;]==&#39;C&#39;) &amp; (input[&#39;popsrc&#39;]==&#39;D&#39;)]

def remove_na_sic(input: pd.DataFrame, sic_field: str):
    &#39;&#39;&#39;
    Remove all observations without SIC

    Parameters
    ----------
    input : pd.DataFrame
        Input dataset.
    sic_field : str
        SIC column name.

    Returns
    -------
    TYPE
        Dataset withou any observations without SIC.

    &#39;&#39;&#39;
    
    
    
    return input[(input[sic_field]&gt;=1) &amp; (input[sic_field]&lt;=9999)]
    
def remove_sic_between(input: pd.DataFrame, sic_field, sic_from, sic_to):
    &#39;&#39;&#39;
    Remove observations with SIC between &#39;sic_from&#39; and &#39;sic_to&#39;

    Parameters
    ----------
    input : pd.DataFrame
        Input dataset.
    sic_field : str
        SIC column name.
    sic_from : TYPE
        The starting SIC code, inclusive.
    sic_to : TYPE
        The ending SIC code, inclusive.

    Returns
    -------
    TYPE
        DESCRIPTION.

    &#39;&#39;&#39;
    
    return input[~((input[sic_field]&gt;=sic_from) &amp; (input[sic_field]&lt;=sic_to))]

def winsorize(data: pd.DataFrame, truncated:bool = False, columns:list = [], limits:float = 0.01, nan_policy = &#39;propagate&#39;):
    &#39;&#39;&#39;
    Winsorize columns.

    Parameters
    ----------
    data : pd.DataFrame
        Input dataset.
    truncated : bool, optional
        Whether the columns will be truncated. The default is False.
    columns : List, optional
        List of the names of columns to be winsorized. The default is [].
    limits : float, optional
        Winsorization limit. The default is 0.01.
    nan_policy{‘propagate’, ‘raise’, ‘omit’}, optional
        Defines how to handle when input contains nan. The following options are available (default is ‘propagate’):
            ‘propagate’: allows nan values and may overwrite or propagate them
            ‘raise’: throws an error
            ‘omit’: performs the calculations ignoring nan values
    Returns
    -------
    data : TYPE
        Winsorized dataset.

    &#39;&#39;&#39;
    
    for col in columns: 
         data[col] = stats.mstats.winsorize(data[col], limits=limits, inclusive = (truncated, truncated), nan_policy = nan_policy)
    return data

class Sample:
    
    
    
    def __init__(self):
        self.sample = pd.DataFrame(columns=[&#39;&#39;,&#39;Observations&#39;])
    def add(self, data: pd.DataFrame, description: str):
        self.sample.loc[len(self.sample)] = [description, data.shape[0]]
    def save(self, path=&#39;data/sample.pkl&#39;):
        self.sample.to_pickle(path)
    def load(self, path=&#39;data/sample.pkl&#39;):
        self.sample = pd.read_pickle(path)
    def get(self):
        return self.sample
    def print(self):
        display(Markdown(self.sample.sample.to_markdown(index=False)))    </code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="brt.add_ff12"><code class="name flex">
<span>def <span class="ident">add_ff12</span></span>(<span>input: pandas.core.frame.DataFrame, sic='sic', code='ff12', description=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Add Fama-French 12-factor code and description.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>TYPE</code></dt>
<dd>Input data.</dd>
<dt><strong><code>sic</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>SIC column name. The default is 'sic'.</dd>
<dt><strong><code>code</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>FF12 output column name. The default is 'ff12'.</dd>
<dt><strong><code>description</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>FF12 description output column name. Description will only be added if it is not None. The default is None.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>TYPE</code></dt>
<dd>DataFrame with added FF12 code and description if 'description' is not None.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_ff12(input:pd.DataFrame, sic=&#39;sic&#39;, code = &#39;ff12&#39;, description = None):
    &#39;&#39;&#39;    
    Add Fama-French 12-factor code and description.

    Parameters
    ----------
    input : TYPE
        Input data.
    sic : str, optional
        SIC column name. The default is &#39;sic&#39;.
    code : str, optional
        FF12 output column name. The default is &#39;ff12&#39;.
    description : str, optional
        FF12 description output column name. Description will only be added if it is not None. The default is None.

    Returns
    -------
    input : TYPE
        DataFrame with added FF12 code and description if &#39;description&#39; is not None.

    &#39;&#39;&#39;
    
    
    input[code] = np.nan
    if(description!=None):
        input[description] = np.nan
    input.loc[(input[sic].between(100,999)) | (input[sic].between(2000,2399)) | (input[sic].between(2700,2749)) | (input[sic].between(2770,2799)) | (input[sic].between(3100,3199)) | (input[sic].between(3940,3989)), code] = 1
    if(description!=None):
        input.loc[(input[sic].between(100,999)) | (input[sic].between(2000,2399)) | (input[sic].between(2700,2749)) | (input[sic].between(2770,2799)) | (input[sic].between(3100,3199)) | (input[sic].between(3940,3989)), description] = &#39;NoDur  Consumer Nondurables -- Food, Tobacco, Textiles, Apparel, Leather, Toys&#39;
    input.loc[(input[sic].between(2500,2519)) | (input[sic].between(2590,2599)) | (input[sic].between(3630,3659)) | (input[sic].between(3710,3711)) | (input[sic].between(3714,3714)) | (input[sic].between(3716,3716)) | (input[sic].between(3750,3751)) | (input[sic].between(3792,3792)) | (input[sic].between(3900,3939)) | (input[sic].between(3990,3999)), code] = 2
    if(description!=None):
        input.loc[(input[sic].between(2500,2519)) | (input[sic].between(2590,2599)) | (input[sic].between(3630,3659)) | (input[sic].between(3710,3711)) | (input[sic].between(3714,3714)) | (input[sic].between(3716,3716)) | (input[sic].between(3750,3751)) | (input[sic].between(3792,3792)) | (input[sic].between(3900,3939)) | (input[sic].between(3990,3999)), description] = &#39;Durbl  Consumer Durables -- Cars, TVs, Furniture, Household Appliances&#39;
    input.loc[(input[sic].between(2520,2589)) | (input[sic].between(2600,2699)) | (input[sic].between(2750,2769)) | (input[sic].between(3000,3099)) | (input[sic].between(3200,3569)) | (input[sic].between(3580,3629)) | (input[sic].between(3700,3709)) | (input[sic].between(3712,3713)) | (input[sic].between(3715,3715)) | (input[sic].between(3717,3749)) | (input[sic].between(3752,3791)) | (input[sic].between(3793,3799)) | (input[sic].between(3830,3839)) | (input[sic].between(3860,3899)), code] = 3
    if(description!=None):
        input.loc[(input[sic].between(2520,2589)) | (input[sic].between(2600,2699)) | (input[sic].between(2750,2769)) | (input[sic].between(3000,3099)) | (input[sic].between(3200,3569)) | (input[sic].between(3580,3629)) | (input[sic].between(3700,3709)) | (input[sic].between(3712,3713)) | (input[sic].between(3715,3715)) | (input[sic].between(3717,3749)) | (input[sic].between(3752,3791)) | (input[sic].between(3793,3799)) | (input[sic].between(3830,3839)) | (input[sic].between(3860,3899)), description] = &#39;Manuf  Manufacturing -- Machinery, Trucks, Planes, Off Furn, Paper, Com Printing&#39;
    input.loc[(input[sic].between(1200,1399)) | (input[sic].between(2900,2999)), code] = 4
    if(description!=None):
        input.loc[(input[sic].between(1200,1399)) | (input[sic].between(2900,2999)), description] = &#39;Enrgy  Oil, Gas, and Coal Extraction and Products&#39;
    input.loc[(input[sic].between(2800,2829)) | (input[sic].between(2840,2899)), code] = 5
    if(description!=None):
        input.loc[(input[sic].between(2800,2829)) | (input[sic].between(2840,2899)), description] = &#39;Chems  Chemicals and Allied Products&#39;
    input.loc[(input[sic].between(3570,3579)) | (input[sic].between(3660,3692)) | (input[sic].between(3694,3699)) | (input[sic].between(3810,3829)) | (input[sic].between(7370,7379)), code] = 6
    if(description!=None):
        input.loc[(input[sic].between(3570,3579)) | (input[sic].between(3660,3692)) | (input[sic].between(3694,3699)) | (input[sic].between(3810,3829)) | (input[sic].between(7370,7379)), description] = &#39;BusEq  Business Equipment -- Computers, Software, and Electronic Equipment&#39;
    input.loc[(input[sic].between(4800,4899)), code] = 7
    if(description!=None):
        input.loc[(input[sic].between(4800,4899)), description] = &#39;Telcm  Telephone and Television Transmission&#39;
    input.loc[(input[sic].between(4900,4949)), code] = 8
    if(description!=None):
        input.loc[(input[sic].between(4900,4949)), description] = &#39;Utils  Utilities&#39;
    input.loc[(input[sic].between(5000,5999)) | (input[sic].between(7200,7299)) | (input[sic].between(7600,7699)), code] = 9
    if(description!=None):
        input.loc[(input[sic].between(5000,5999)) | (input[sic].between(7200,7299)) | (input[sic].between(7600,7699)), description] = &#39;Shops  Wholesale, Retail, and Some Services (Laundries, Repair Shops)&#39;
    input.loc[(input[sic].between(2830,2839)) | (input[sic].between(3693,3693)) | (input[sic].between(3840,3859)) | (input[sic].between(8000,8099)), code] = 10
    if(description!=None):
        input.loc[(input[sic].between(2830,2839)) | (input[sic].between(3693,3693)) | (input[sic].between(3840,3859)) | (input[sic].between(8000,8099)), description] = &#39;Hlth   Healthcare, Medical Equipment, and Drugs&#39;
    input.loc[(input[sic].between(6000,6999)), code] = 11
    if(description!=None):
        input.loc[(input[sic].between(6000,6999)), description] = &#39;Money  Finance&#39;
    input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), code] = 12
    if(description!=None):
        input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), description] = &#39;Other  Other -- Mines, Constr, BldMt, Trans, Hotels, Bus Serv, Entertainment&#39;
    return input</code></pre>
</details>
</dd>
<dt id="brt.add_ff38"><code class="name flex">
<span>def <span class="ident">add_ff38</span></span>(<span>input: pandas.core.frame.DataFrame, sic='sic', code='ff38', description=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Add Fama-French 38-factor code and description.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>TYPE</code></dt>
<dd>Input data.</dd>
<dt><strong><code>sic</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>SIC column name. The default is 'sic'.</dd>
<dt><strong><code>code</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>FF38 output column name. The default is 'ff38'.</dd>
<dt><strong><code>description</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>FF38 description output column name. Description will only be added if it is not None. The default is None.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>TYPE</code></dt>
<dd>DataFrame with added FF38 code and description if 'description' is not None.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_ff38(input:pd.DataFrame, sic=&#39;sic&#39;, code = &#39;ff38&#39;, description = None):
    
    &#39;&#39;&#39;    
    Add Fama-French 38-factor code and description.

    Parameters
    ----------
    input : TYPE
        Input data.
    sic : str, optional
        SIC column name. The default is &#39;sic&#39;.
    code : str, optional
        FF38 output column name. The default is &#39;ff38&#39;.
    description : str, optional
        FF38 description output column name. Description will only be added if it is not None. The default is None.

    Returns
    -------
    input : TYPE
        DataFrame with added FF38 code and description if &#39;description&#39; is not None.

    &#39;&#39;&#39;
    
    input[code] = np.nan
    if(description!=None):
        input[description] = np.nan
    input.loc[(input[sic].between(100,999)), code] = 1
    if(description!=None):
        input.loc[(input[sic].between(100,999)), description] = &#39;Agric  Agriculture, forestry, and fishing&#39;
    input.loc[(input[sic].between(1000,1299)), code] = 2
    if(description!=None):
        input.loc[(input[sic].between(1000,1299)), description] = &#39;Mines  Mining&#39;
    input.loc[(input[sic].between(1300,1399)), code] = 3
    if(description!=None):
        input.loc[(input[sic].between(1300,1399)), description] = &#39;Oil    Oil and Gas Extraction&#39;
    input.loc[(input[sic].between(1400,1499)), code] = 4
    if(description!=None):
        input.loc[(input[sic].between(1400,1499)), description] = &#39;Stone  Nonmetallic Minerals Except Fuels&#39;
    input.loc[(input[sic].between(1500,1799)), code] = 5
    if(description!=None):
        input.loc[(input[sic].between(1500,1799)), description] = &#39;Cnstr  Construction&#39;
    input.loc[(input[sic].between(2000,2099)), code] = 6
    if(description!=None):
        input.loc[(input[sic].between(2000,2099)), description] = &#39;Food   Food and Kindred Products&#39;
    input.loc[(input[sic].between(2100,2199)), code] = 7
    if(description!=None):
        input.loc[(input[sic].between(2100,2199)), description] = &#39;Smoke  Tobacco Products&#39;
    input.loc[(input[sic].between(2200,2299)), code] = 8
    if(description!=None):
        input.loc[(input[sic].between(2200,2299)), description] = &#39;Txtls  Textile Mill Products&#39;
    input.loc[(input[sic].between(2300,2399)), code] = 9
    if(description!=None):
        input.loc[(input[sic].between(2300,2399)), description] = &#39;Apprl  Apparel and other Textile Products&#39;
    input.loc[(input[sic].between(2400,2499)), code] = 10
    if(description!=None):
        input.loc[(input[sic].between(2400,2499)), description] = &#39;Wood   Lumber and Wood Products&#39;
    input.loc[(input[sic].between(2500,2599)), code] = 11
    if(description!=None):
        input.loc[(input[sic].between(2500,2599)), description] = &#39;Chair  Furniture and Fixtures&#39;
    input.loc[(input[sic].between(2600,2661)), code] = 12
    if(description!=None):
        input.loc[(input[sic].between(2600,2661)), description] = &#39;Paper  Paper and Allied Products&#39;
    input.loc[(input[sic].between(2700,2799)), code] = 13
    if(description!=None):
        input.loc[(input[sic].between(2700,2799)), description] = &#39;Print  Printing and Publishing&#39;
    input.loc[(input[sic].between(2800,2899)), code] = 14
    if(description!=None):
        input.loc[(input[sic].between(2800,2899)), description] = &#39;Chems  Chemicals and Allied Products&#39;
    input.loc[(input[sic].between(2900,2999)), code] = 15
    if(description!=None):
        input.loc[(input[sic].between(2900,2999)), description] = &#39;Ptrlm  Petroleum and Coal Products&#39;
    input.loc[(input[sic].between(3000,3099)), code] = 16
    if(description!=None):
        input.loc[(input[sic].between(3000,3099)), description] = &#39;Rubbr  Rubber and Miscellaneous Plastics Products&#39;
    input.loc[(input[sic].between(3100,3199)), code] = 17
    if(description!=None):
        input.loc[(input[sic].between(3100,3199)), description] = &#39;Lethr  Leather and Leather Products&#39;
    input.loc[(input[sic].between(3200,3299)), code] = 18
    if(description!=None):
        input.loc[(input[sic].between(3200,3299)), description] = &#39;Glass  Stone, Clay and Glass Products&#39;
    input.loc[(input[sic].between(3300,3399)), code] = 19
    if(description!=None):
        input.loc[(input[sic].between(3300,3399)), description] = &#39;Metal  Primary Metal Industries&#39;
    input.loc[(input[sic].between(3400,3499)), code] = 20
    if(description!=None):
        input.loc[(input[sic].between(3400,3499)), description] = &#39;MtlPr  Fabricated Metal Products&#39;
    input.loc[(input[sic].between(3500,3599)), code] = 21
    if(description!=None):
        input.loc[(input[sic].between(3500,3599)), description] = &#39;Machn  Machinery, Except Electrical&#39;
    input.loc[(input[sic].between(3600,3699)), code] = 22
    if(description!=None):
        input.loc[(input[sic].between(3600,3699)), description] = &#39;Elctr  Electrical and Electronic Equipment&#39;
    input.loc[(input[sic].between(3700,3799)), code] = 23
    if(description!=None):
        input.loc[(input[sic].between(3700,3799)), description] = &#39;Cars   Transportation Equipment&#39;
    input.loc[(input[sic].between(3800,3879)), code] = 24
    if(description!=None):
        input.loc[(input[sic].between(3800,3879)), description] = &#39;Instr  Instruments and Related Products&#39;
    input.loc[(input[sic].between(3900,3999)), code] = 25
    if(description!=None):
        input.loc[(input[sic].between(3900,3999)), description] = &#39;Manuf  Miscellaneous Manufacturing Industries&#39;
    input.loc[(input[sic].between(4000,4799)), code] = 26
    if(description!=None):
        input.loc[(input[sic].between(4000,4799)), description] = &#39;Trans  Transportation&#39;
    input.loc[(input[sic].between(4800,4829)), code] = 27
    if(description!=None):
        input.loc[(input[sic].between(4800,4829)), description] = &#39;Phone  Telephone and Telegraph Communication&#39;
    input.loc[(input[sic].between(4830,4899)), code] = 28
    if(description!=None):
        input.loc[(input[sic].between(4830,4899)), description] = &#39;TV     Radio and Television Broadcasting&#39;
    input.loc[(input[sic].between(4900,4949)), code] = 29
    if(description!=None):
        input.loc[(input[sic].between(4900,4949)), description] = &#39;Utils  Electric, Gas, and Water Supply&#39;
    input.loc[(input[sic].between(4950,4959)), code] = 30
    if(description!=None):
        input.loc[(input[sic].between(4950,4959)), description] = &#39;Garbg  Sanitary Services&#39;
    input.loc[(input[sic].between(4960,4969)), code] = 31
    if(description!=None):
        input.loc[(input[sic].between(4960,4969)), description] = &#39;Steam  Steam Supply&#39;
    input.loc[(input[sic].between(4970,4979)), code] = 32
    if(description!=None):
        input.loc[(input[sic].between(4970,4979)), description] = &#39;Water  Irrigation Systems&#39;
    input.loc[(input[sic].between(5000,5199)), code] = 33
    if(description!=None):
        input.loc[(input[sic].between(5000,5199)), description] = &#39;Whlsl  Wholesale&#39;
    input.loc[(input[sic].between(5200,5999)), code] = 34
    if(description!=None):
        input.loc[(input[sic].between(5200,5999)), description] = &#39;Rtail  Retail Stores&#39;
    input.loc[(input[sic].between(6000,6999)), code] = 35
    if(description!=None):
        input.loc[(input[sic].between(6000,6999)), description] = &#39;Money  Finance, Insurance, and Real Estate&#39;
    input.loc[(input[sic].between(7000,8999)), code] = 36
    if(description!=None):
        input.loc[(input[sic].between(7000,8999)), description] = &#39;Srvc   Services&#39;
    input.loc[(input[sic].between(9000,9999)), code] = 37
    if(description!=None):
        input.loc[(input[sic].between(9000,9999)), description] = &#39;Govt   Public Administration&#39;
    input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), code] = 38
    if(description!=None):
        input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), description] = &#39;Other  Almost Nothing&#39;
    return input</code></pre>
</details>
</dd>
<dt id="brt.add_ff48"><code class="name flex">
<span>def <span class="ident">add_ff48</span></span>(<span>input: pandas.core.frame.DataFrame, sic='sic', code='ff48', description=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Add Fama-French 48-factor code and description.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>TYPE</code></dt>
<dd>Input data.</dd>
<dt><strong><code>sic</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>SIC column name. The default is 'sic'.</dd>
<dt><strong><code>code</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>FF48 output column name. The default is 'ff48'.</dd>
<dt><strong><code>description</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>FF48 description output column name. Description will only be added if it is not None. The default is None.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>TYPE</code></dt>
<dd>DataFrame with added FF48 code and description if 'description' is not None.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_ff48(input:pd.DataFrame, sic=&#39;sic&#39;, code = &#39;ff48&#39;, description = None):
    &#39;&#39;&#39;    
    Add Fama-French 48-factor code and description.

    Parameters
    ----------
    input : TYPE
        Input data.
    sic : str, optional
        SIC column name. The default is &#39;sic&#39;.
    code : str, optional
        FF48 output column name. The default is &#39;ff48&#39;.
    description : str, optional
        FF48 description output column name. Description will only be added if it is not None. The default is None.

    Returns
    -------
    input : TYPE
        DataFrame with added FF48 code and description if &#39;description&#39; is not None.

    &#39;&#39;&#39;
    
    
    input[code] = np.nan
    if(description!=None):
        input[description] = np.nan
    input.loc[(input[sic].between(100,199)) | (input[sic].between(200,299)) | (input[sic].between(700,799)) | (input[sic].between(910,919)) | (input[sic].between(2048,2048)), code] = 1
    if(description!=None):
        input.loc[(input[sic].between(100,199)) | (input[sic].between(200,299)) | (input[sic].between(700,799)) | (input[sic].between(910,919)) | (input[sic].between(2048,2048)), description] = &#39;Agric  Agriculture&#39;
    input.loc[(input[sic].between(2000,2009)) | (input[sic].between(2010,2019)) | (input[sic].between(2020,2029)) | (input[sic].between(2030,2039)) | (input[sic].between(2040,2046)) | (input[sic].between(2050,2059)) | (input[sic].between(2060,2063)) | (input[sic].between(2070,2079)) | (input[sic].between(2090,2092)) | (input[sic].between(2095,2095)) | (input[sic].between(2098,2099)), code] = 2
    if(description!=None):
        input.loc[(input[sic].between(2000,2009)) | (input[sic].between(2010,2019)) | (input[sic].between(2020,2029)) | (input[sic].between(2030,2039)) | (input[sic].between(2040,2046)) | (input[sic].between(2050,2059)) | (input[sic].between(2060,2063)) | (input[sic].between(2070,2079)) | (input[sic].between(2090,2092)) | (input[sic].between(2095,2095)) | (input[sic].between(2098,2099)), description] = &#39;Food   Food Products&#39;
    input.loc[(input[sic].between(2064,2068)) | (input[sic].between(2086,2086)) | (input[sic].between(2087,2087)) | (input[sic].between(2096,2096)) | (input[sic].between(2097,2097)), code] = 3
    if(description!=None):
        input.loc[(input[sic].between(2064,2068)) | (input[sic].between(2086,2086)) | (input[sic].between(2087,2087)) | (input[sic].between(2096,2096)) | (input[sic].between(2097,2097)), description] = &#39;Soda   Candy &amp; Soda&#39;
    input.loc[(input[sic].between(2080,2080)) | (input[sic].between(2082,2082)) | (input[sic].between(2083,2083)) | (input[sic].between(2084,2084)) | (input[sic].between(2085,2085)), code] = 4
    if(description!=None):
        input.loc[(input[sic].between(2080,2080)) | (input[sic].between(2082,2082)) | (input[sic].between(2083,2083)) | (input[sic].between(2084,2084)) | (input[sic].between(2085,2085)), description] = &#39;Beer   Beer &amp; Liquor&#39;
    input.loc[(input[sic].between(2100,2199)), code] = 5
    if(description!=None):
        input.loc[(input[sic].between(2100,2199)), description] = &#39;Smoke  Tobacco Products&#39;
    input.loc[(input[sic].between(920,999)) | (input[sic].between(3650,3651)) | (input[sic].between(3652,3652)) | (input[sic].between(3732,3732)) | (input[sic].between(3930,3931)) | (input[sic].between(3940,3949)), code] = 6
    if(description!=None):
        input.loc[(input[sic].between(920,999)) | (input[sic].between(3650,3651)) | (input[sic].between(3652,3652)) | (input[sic].between(3732,3732)) | (input[sic].between(3930,3931)) | (input[sic].between(3940,3949)), description] = &#39;Toys   Recreation&#39;
    input.loc[(input[sic].between(7800,7829)) | (input[sic].between(7830,7833)) | (input[sic].between(7840,7841)) | (input[sic].between(7900,7900)) | (input[sic].between(7910,7911)) | (input[sic].between(7920,7929)) | (input[sic].between(7930,7933)) | (input[sic].between(7940,7949)) | (input[sic].between(7980,7980)) | (input[sic].between(7990,7999)), code] = 7
    if(description!=None):
        input.loc[(input[sic].between(7800,7829)) | (input[sic].between(7830,7833)) | (input[sic].between(7840,7841)) | (input[sic].between(7900,7900)) | (input[sic].between(7910,7911)) | (input[sic].between(7920,7929)) | (input[sic].between(7930,7933)) | (input[sic].between(7940,7949)) | (input[sic].between(7980,7980)) | (input[sic].between(7990,7999)), description] = &#39;Fun    Entertainment&#39;
    input.loc[(input[sic].between(2700,2709)) | (input[sic].between(2710,2719)) | (input[sic].between(2720,2729)) | (input[sic].between(2730,2739)) | (input[sic].between(2740,2749)) | (input[sic].between(2770,2771)) | (input[sic].between(2780,2789)) | (input[sic].between(2790,2799)), code] = 8
    if(description!=None):
        input.loc[(input[sic].between(2700,2709)) | (input[sic].between(2710,2719)) | (input[sic].between(2720,2729)) | (input[sic].between(2730,2739)) | (input[sic].between(2740,2749)) | (input[sic].between(2770,2771)) | (input[sic].between(2780,2789)) | (input[sic].between(2790,2799)), description] = &#39;Books  Printing and Publishing&#39;
    input.loc[(input[sic].between(2047,2047)) | (input[sic].between(2391,2392)) | (input[sic].between(2510,2519)) | (input[sic].between(2590,2599)) | (input[sic].between(2840,2843)) | (input[sic].between(2844,2844)) | (input[sic].between(3160,3161)) | (input[sic].between(3170,3171)) | (input[sic].between(3172,3172)) | (input[sic].between(3190,3199)) | (input[sic].between(3229,3229)) | (input[sic].between(3260,3260)) | (input[sic].between(3262,3263)) | (input[sic].between(3269,3269)) | (input[sic].between(3230,3231)) | (input[sic].between(3630,3639)) | (input[sic].between(3750,3751)) | (input[sic].between(3800,3800)) | (input[sic].between(3860,3861)) | (input[sic].between(3870,3873)) | (input[sic].between(3910,3911)) | (input[sic].between(3914,3914)) | (input[sic].between(3915,3915)) | (input[sic].between(3960,3962)) | (input[sic].between(3991,3991)) | (input[sic].between(3995,3995)), code] = 9
    if(description!=None):
        input.loc[(input[sic].between(2047,2047)) | (input[sic].between(2391,2392)) | (input[sic].between(2510,2519)) | (input[sic].between(2590,2599)) | (input[sic].between(2840,2843)) | (input[sic].between(2844,2844)) | (input[sic].between(3160,3161)) | (input[sic].between(3170,3171)) | (input[sic].between(3172,3172)) | (input[sic].between(3190,3199)) | (input[sic].between(3229,3229)) | (input[sic].between(3260,3260)) | (input[sic].between(3262,3263)) | (input[sic].between(3269,3269)) | (input[sic].between(3230,3231)) | (input[sic].between(3630,3639)) | (input[sic].between(3750,3751)) | (input[sic].between(3800,3800)) | (input[sic].between(3860,3861)) | (input[sic].between(3870,3873)) | (input[sic].between(3910,3911)) | (input[sic].between(3914,3914)) | (input[sic].between(3915,3915)) | (input[sic].between(3960,3962)) | (input[sic].between(3991,3991)) | (input[sic].between(3995,3995)), description] = &#39;Hshld  Consumer Goods&#39;
    input.loc[(input[sic].between(2300,2390)) | (input[sic].between(3020,3021)) | (input[sic].between(3100,3111)) | (input[sic].between(3130,3131)) | (input[sic].between(3140,3149)) | (input[sic].between(3150,3151)) | (input[sic].between(3963,3965)), code] = 10
    if(description!=None):
        input.loc[(input[sic].between(2300,2390)) | (input[sic].between(3020,3021)) | (input[sic].between(3100,3111)) | (input[sic].between(3130,3131)) | (input[sic].between(3140,3149)) | (input[sic].between(3150,3151)) | (input[sic].between(3963,3965)), description] = &#39;Clths  Apparel&#39;
    input.loc[(input[sic].between(8000,8099)), code] = 11
    if(description!=None):
        input.loc[(input[sic].between(8000,8099)), description] = &#39;Hlth   Healthcare&#39;
    input.loc[(input[sic].between(3693,3693)) | (input[sic].between(3840,3849)) | (input[sic].between(3850,3851)), code] = 12
    if(description!=None):
        input.loc[(input[sic].between(3693,3693)) | (input[sic].between(3840,3849)) | (input[sic].between(3850,3851)), description] = &#39;MedEq  Medical Equipment&#39;
    input.loc[(input[sic].between(2830,2830)) | (input[sic].between(2831,2831)) | (input[sic].between(2833,2833)) | (input[sic].between(2834,2834)) | (input[sic].between(2835,2835)) | (input[sic].between(2836,2836)), code] = 13
    if(description!=None):
        input.loc[(input[sic].between(2830,2830)) | (input[sic].between(2831,2831)) | (input[sic].between(2833,2833)) | (input[sic].between(2834,2834)) | (input[sic].between(2835,2835)) | (input[sic].between(2836,2836)), description] = &#39;Drugs  Pharmaceutical Products&#39;
    input.loc[(input[sic].between(2800,2809)) | (input[sic].between(2810,2819)) | (input[sic].between(2820,2829)) | (input[sic].between(2850,2859)) | (input[sic].between(2860,2869)) | (input[sic].between(2870,2879)) | (input[sic].between(2890,2899)), code] = 14
    if(description!=None):
        input.loc[(input[sic].between(2800,2809)) | (input[sic].between(2810,2819)) | (input[sic].between(2820,2829)) | (input[sic].between(2850,2859)) | (input[sic].between(2860,2869)) | (input[sic].between(2870,2879)) | (input[sic].between(2890,2899)), description] = &#39;Chems  Chemicals&#39;
    input.loc[(input[sic].between(3031,3031)) | (input[sic].between(3041,3041)) | (input[sic].between(3050,3053)) | (input[sic].between(3060,3069)) | (input[sic].between(3070,3079)) | (input[sic].between(3080,3089)) | (input[sic].between(3090,3099)), code] = 15
    if(description!=None):
        input.loc[(input[sic].between(3031,3031)) | (input[sic].between(3041,3041)) | (input[sic].between(3050,3053)) | (input[sic].between(3060,3069)) | (input[sic].between(3070,3079)) | (input[sic].between(3080,3089)) | (input[sic].between(3090,3099)), description] = &#39;Rubbr  Rubber and Plastic Products&#39;
    input.loc[(input[sic].between(2200,2269)) | (input[sic].between(2270,2279)) | (input[sic].between(2280,2284)) | (input[sic].between(2290,2295)) | (input[sic].between(2297,2297)) | (input[sic].between(2298,2298)) | (input[sic].between(2299,2299)) | (input[sic].between(2393,2395)) | (input[sic].between(2397,2399)), code] = 16
    if(description!=None):
        input.loc[(input[sic].between(2200,2269)) | (input[sic].between(2270,2279)) | (input[sic].between(2280,2284)) | (input[sic].between(2290,2295)) | (input[sic].between(2297,2297)) | (input[sic].between(2298,2298)) | (input[sic].between(2299,2299)) | (input[sic].between(2393,2395)) | (input[sic].between(2397,2399)), description] = &#39;Txtls  Textiles&#39;
    input.loc[(input[sic].between(800,899)) | (input[sic].between(2400,2439)) | (input[sic].between(2450,2459)) | (input[sic].between(2490,2499)) | (input[sic].between(2660,2661)) | (input[sic].between(2950,2952)) | (input[sic].between(3200,3200)) | (input[sic].between(3210,3211)) | (input[sic].between(3240,3241)) | (input[sic].between(3250,3259)) | (input[sic].between(3261,3261)) | (input[sic].between(3264,3264)) | (input[sic].between(3270,3275)) | (input[sic].between(3280,3281)) | (input[sic].between(3290,3293)) | (input[sic].between(3295,3299)) | (input[sic].between(3420,3429)) | (input[sic].between(3430,3433)) | (input[sic].between(3440,3441)) | (input[sic].between(3442,3442)) | (input[sic].between(3446,3446)) | (input[sic].between(3448,3448)) | (input[sic].between(3449,3449)) | (input[sic].between(3450,3451)) | (input[sic].between(3452,3452)) | (input[sic].between(3490,3499)) | (input[sic].between(3996,3996)), code] = 17
    if(description!=None):
        input.loc[(input[sic].between(800,899)) | (input[sic].between(2400,2439)) | (input[sic].between(2450,2459)) | (input[sic].between(2490,2499)) | (input[sic].between(2660,2661)) | (input[sic].between(2950,2952)) | (input[sic].between(3200,3200)) | (input[sic].between(3210,3211)) | (input[sic].between(3240,3241)) | (input[sic].between(3250,3259)) | (input[sic].between(3261,3261)) | (input[sic].between(3264,3264)) | (input[sic].between(3270,3275)) | (input[sic].between(3280,3281)) | (input[sic].between(3290,3293)) | (input[sic].between(3295,3299)) | (input[sic].between(3420,3429)) | (input[sic].between(3430,3433)) | (input[sic].between(3440,3441)) | (input[sic].between(3442,3442)) | (input[sic].between(3446,3446)) | (input[sic].between(3448,3448)) | (input[sic].between(3449,3449)) | (input[sic].between(3450,3451)) | (input[sic].between(3452,3452)) | (input[sic].between(3490,3499)) | (input[sic].between(3996,3996)), description] = &#39;BldMt  Construction Materials&#39;
    input.loc[(input[sic].between(1500,1511)) | (input[sic].between(1520,1529)) | (input[sic].between(1530,1539)) | (input[sic].between(1540,1549)) | (input[sic].between(1600,1699)) | (input[sic].between(1700,1799)), code] = 18
    if(description!=None):
        input.loc[(input[sic].between(1500,1511)) | (input[sic].between(1520,1529)) | (input[sic].between(1530,1539)) | (input[sic].between(1540,1549)) | (input[sic].between(1600,1699)) | (input[sic].between(1700,1799)), description] = &#39;Cnstr  Construction&#39;
    input.loc[(input[sic].between(3300,3300)) | (input[sic].between(3310,3317)) | (input[sic].between(3320,3325)) | (input[sic].between(3330,3339)) | (input[sic].between(3340,3341)) | (input[sic].between(3350,3357)) | (input[sic].between(3360,3369)) | (input[sic].between(3370,3379)) | (input[sic].between(3390,3399)), code] = 19
    if(description!=None):
        input.loc[(input[sic].between(3300,3300)) | (input[sic].between(3310,3317)) | (input[sic].between(3320,3325)) | (input[sic].between(3330,3339)) | (input[sic].between(3340,3341)) | (input[sic].between(3350,3357)) | (input[sic].between(3360,3369)) | (input[sic].between(3370,3379)) | (input[sic].between(3390,3399)), description] = &#39;Steel  Steel Works Etc&#39;
    input.loc[(input[sic].between(3400,3400)) | (input[sic].between(3443,3443)) | (input[sic].between(3444,3444)) | (input[sic].between(3460,3469)) | (input[sic].between(3470,3479)), code] = 20
    if(description!=None):
        input.loc[(input[sic].between(3400,3400)) | (input[sic].between(3443,3443)) | (input[sic].between(3444,3444)) | (input[sic].between(3460,3469)) | (input[sic].between(3470,3479)), description] = &#39;FabPr  Fabricated Products&#39;
    input.loc[(input[sic].between(3510,3519)) | (input[sic].between(3520,3529)) | (input[sic].between(3530,3530)) | (input[sic].between(3531,3531)) | (input[sic].between(3532,3532)) | (input[sic].between(3533,3533)) | (input[sic].between(3534,3534)) | (input[sic].between(3535,3535)) | (input[sic].between(3536,3536)) | (input[sic].between(3538,3538)) | (input[sic].between(3540,3549)) | (input[sic].between(3550,3559)) | (input[sic].between(3560,3569)) | (input[sic].between(3580,3580)) | (input[sic].between(3581,3581)) | (input[sic].between(3582,3582)) | (input[sic].between(3585,3585)) | (input[sic].between(3586,3586)) | (input[sic].between(3589,3589)) | (input[sic].between(3590,3599)), code] = 21
    if(description!=None):
        input.loc[(input[sic].between(3510,3519)) | (input[sic].between(3520,3529)) | (input[sic].between(3530,3530)) | (input[sic].between(3531,3531)) | (input[sic].between(3532,3532)) | (input[sic].between(3533,3533)) | (input[sic].between(3534,3534)) | (input[sic].between(3535,3535)) | (input[sic].between(3536,3536)) | (input[sic].between(3538,3538)) | (input[sic].between(3540,3549)) | (input[sic].between(3550,3559)) | (input[sic].between(3560,3569)) | (input[sic].between(3580,3580)) | (input[sic].between(3581,3581)) | (input[sic].between(3582,3582)) | (input[sic].between(3585,3585)) | (input[sic].between(3586,3586)) | (input[sic].between(3589,3589)) | (input[sic].between(3590,3599)), description] = &#39;Mach   Machinery&#39;
    input.loc[(input[sic].between(3600,3600)) | (input[sic].between(3610,3613)) | (input[sic].between(3620,3621)) | (input[sic].between(3623,3629)) | (input[sic].between(3640,3644)) | (input[sic].between(3645,3645)) | (input[sic].between(3646,3646)) | (input[sic].between(3648,3649)) | (input[sic].between(3660,3660)) | (input[sic].between(3690,3690)) | (input[sic].between(3691,3692)) | (input[sic].between(3699,3699)), code] = 22
    if(description!=None):
        input.loc[(input[sic].between(3600,3600)) | (input[sic].between(3610,3613)) | (input[sic].between(3620,3621)) | (input[sic].between(3623,3629)) | (input[sic].between(3640,3644)) | (input[sic].between(3645,3645)) | (input[sic].between(3646,3646)) | (input[sic].between(3648,3649)) | (input[sic].between(3660,3660)) | (input[sic].between(3690,3690)) | (input[sic].between(3691,3692)) | (input[sic].between(3699,3699)), description] = &#39;ElcEq  Electrical Equipment&#39;
    input.loc[(input[sic].between(2296,2296)) | (input[sic].between(2396,2396)) | (input[sic].between(3010,3011)) | (input[sic].between(3537,3537)) | (input[sic].between(3647,3647)) | (input[sic].between(3694,3694)) | (input[sic].between(3700,3700)) | (input[sic].between(3710,3710)) | (input[sic].between(3711,3711)) | (input[sic].between(3713,3713)) | (input[sic].between(3714,3714)) | (input[sic].between(3715,3715)) | (input[sic].between(3716,3716)) | (input[sic].between(3792,3792)) | (input[sic].between(3790,3791)) | (input[sic].between(3799,3799)), code] = 23
    if(description!=None):
        input.loc[(input[sic].between(2296,2296)) | (input[sic].between(2396,2396)) | (input[sic].between(3010,3011)) | (input[sic].between(3537,3537)) | (input[sic].between(3647,3647)) | (input[sic].between(3694,3694)) | (input[sic].between(3700,3700)) | (input[sic].between(3710,3710)) | (input[sic].between(3711,3711)) | (input[sic].between(3713,3713)) | (input[sic].between(3714,3714)) | (input[sic].between(3715,3715)) | (input[sic].between(3716,3716)) | (input[sic].between(3792,3792)) | (input[sic].between(3790,3791)) | (input[sic].between(3799,3799)), description] = &#39;Autos  Automobiles and Trucks&#39;
    input.loc[(input[sic].between(3720,3720)) | (input[sic].between(3721,3721)) | (input[sic].between(3723,3724)) | (input[sic].between(3725,3725)) | (input[sic].between(3728,3729)), code] = 24
    if(description!=None):
        input.loc[(input[sic].between(3720,3720)) | (input[sic].between(3721,3721)) | (input[sic].between(3723,3724)) | (input[sic].between(3725,3725)) | (input[sic].between(3728,3729)), description] = &#39;Aero   Aircraft&#39;
    input.loc[(input[sic].between(3730,3731)) | (input[sic].between(3740,3743)), code] = 25
    if(description!=None):
        input.loc[(input[sic].between(3730,3731)) | (input[sic].between(3740,3743)), description] = &#39;Ships  Shipbuilding, Railroad Equipment&#39;
    input.loc[(input[sic].between(3760,3769)) | (input[sic].between(3795,3795)) | (input[sic].between(3480,3489)), code] = 26
    if(description!=None):
        input.loc[(input[sic].between(3760,3769)) | (input[sic].between(3795,3795)) | (input[sic].between(3480,3489)), description] = &#39;Guns   Defense&#39;
    input.loc[(input[sic].between(1040,1049)), code] = 27
    if(description!=None):
        input.loc[(input[sic].between(1040,1049)), description] = &#39;Gold   Precious Metals&#39;
    input.loc[(input[sic].between(1000,1009)) | (input[sic].between(1010,1019)) | (input[sic].between(1020,1029)) | (input[sic].between(1030,1039)) | (input[sic].between(1050,1059)) | (input[sic].between(1060,1069)) | (input[sic].between(1070,1079)) | (input[sic].between(1080,1089)) | (input[sic].between(1090,1099)) | (input[sic].between(1100,1119)) | (input[sic].between(1400,1499)), code] = 28
    if(description!=None):
        input.loc[(input[sic].between(1000,1009)) | (input[sic].between(1010,1019)) | (input[sic].between(1020,1029)) | (input[sic].between(1030,1039)) | (input[sic].between(1050,1059)) | (input[sic].between(1060,1069)) | (input[sic].between(1070,1079)) | (input[sic].between(1080,1089)) | (input[sic].between(1090,1099)) | (input[sic].between(1100,1119)) | (input[sic].between(1400,1499)), description] = &#39;Mines  Non-Metallic and Industrial Metal Mining&#39;
    input.loc[(input[sic].between(1200,1299)), code] = 29
    if(description!=None):
        input.loc[(input[sic].between(1200,1299)), description] = &#39;Coal   Coal&#39;
    input.loc[(input[sic].between(1300,1300)) | (input[sic].between(1310,1319)) | (input[sic].between(1320,1329)) | (input[sic].between(1330,1339)) | (input[sic].between(1370,1379)) | (input[sic].between(1380,1380)) | (input[sic].between(1381,1381)) | (input[sic].between(1382,1382)) | (input[sic].between(1389,1389)) | (input[sic].between(2900,2912)) | (input[sic].between(2990,2999)), code] = 30
    if(description!=None):
        input.loc[(input[sic].between(1300,1300)) | (input[sic].between(1310,1319)) | (input[sic].between(1320,1329)) | (input[sic].between(1330,1339)) | (input[sic].between(1370,1379)) | (input[sic].between(1380,1380)) | (input[sic].between(1381,1381)) | (input[sic].between(1382,1382)) | (input[sic].between(1389,1389)) | (input[sic].between(2900,2912)) | (input[sic].between(2990,2999)), description] = &#39;Oil    Petroleum and Natural Gas&#39;
    input.loc[(input[sic].between(4900,4900)) | (input[sic].between(4910,4911)) | (input[sic].between(4920,4922)) | (input[sic].between(4923,4923)) | (input[sic].between(4924,4925)) | (input[sic].between(4930,4931)) | (input[sic].between(4932,4932)) | (input[sic].between(4939,4939)) | (input[sic].between(4940,4942)), code] = 31
    if(description!=None):
        input.loc[(input[sic].between(4900,4900)) | (input[sic].between(4910,4911)) | (input[sic].between(4920,4922)) | (input[sic].between(4923,4923)) | (input[sic].between(4924,4925)) | (input[sic].between(4930,4931)) | (input[sic].between(4932,4932)) | (input[sic].between(4939,4939)) | (input[sic].between(4940,4942)), description] = &#39;Util   Utilities&#39;
    input.loc[(input[sic].between(4800,4800)) | (input[sic].between(4810,4813)) | (input[sic].between(4820,4822)) | (input[sic].between(4830,4839)) | (input[sic].between(4840,4841)) | (input[sic].between(4880,4889)) | (input[sic].between(4890,4890)) | (input[sic].between(4891,4891)) | (input[sic].between(4892,4892)) | (input[sic].between(4899,4899)), code] = 32
    if(description!=None):
        input.loc[(input[sic].between(4800,4800)) | (input[sic].between(4810,4813)) | (input[sic].between(4820,4822)) | (input[sic].between(4830,4839)) | (input[sic].between(4840,4841)) | (input[sic].between(4880,4889)) | (input[sic].between(4890,4890)) | (input[sic].between(4891,4891)) | (input[sic].between(4892,4892)) | (input[sic].between(4899,4899)), description] = &#39;Telcm  Communication&#39;
    input.loc[(input[sic].between(7020,7021)) | (input[sic].between(7030,7033)) | (input[sic].between(7200,7200)) | (input[sic].between(7210,7212)) | (input[sic].between(7214,7214)) | (input[sic].between(7215,7216)) | (input[sic].between(7217,7217)) | (input[sic].between(7219,7219)) | (input[sic].between(7220,7221)) | (input[sic].between(7230,7231)) | (input[sic].between(7240,7241)) | (input[sic].between(7250,7251)) | (input[sic].between(7260,7269)) | (input[sic].between(7270,7290)) | (input[sic].between(7291,7291)) | (input[sic].between(7292,7299)) | (input[sic].between(7395,7395)) | (input[sic].between(7500,7500)) | (input[sic].between(7520,7529)) | (input[sic].between(7530,7539)) | (input[sic].between(7540,7549)) | (input[sic].between(7600,7600)) | (input[sic].between(7620,7620)) | (input[sic].between(7622,7622)) | (input[sic].between(7623,7623)) | (input[sic].between(7629,7629)) | (input[sic].between(7630,7631)) | (input[sic].between(7640,7641)) | (input[sic].between(7690,7699)) | (input[sic].between(8100,8199)) | (input[sic].between(8200,8299)) | (input[sic].between(8300,8399)) | (input[sic].between(8400,8499)) | (input[sic].between(8600,8699)) | (input[sic].between(8800,8899)) | (input[sic].between(7510,7515)), code] = 33
    if(description!=None):
        input.loc[(input[sic].between(7020,7021)) | (input[sic].between(7030,7033)) | (input[sic].between(7200,7200)) | (input[sic].between(7210,7212)) | (input[sic].between(7214,7214)) | (input[sic].between(7215,7216)) | (input[sic].between(7217,7217)) | (input[sic].between(7219,7219)) | (input[sic].between(7220,7221)) | (input[sic].between(7230,7231)) | (input[sic].between(7240,7241)) | (input[sic].between(7250,7251)) | (input[sic].between(7260,7269)) | (input[sic].between(7270,7290)) | (input[sic].between(7291,7291)) | (input[sic].between(7292,7299)) | (input[sic].between(7395,7395)) | (input[sic].between(7500,7500)) | (input[sic].between(7520,7529)) | (input[sic].between(7530,7539)) | (input[sic].between(7540,7549)) | (input[sic].between(7600,7600)) | (input[sic].between(7620,7620)) | (input[sic].between(7622,7622)) | (input[sic].between(7623,7623)) | (input[sic].between(7629,7629)) | (input[sic].between(7630,7631)) | (input[sic].between(7640,7641)) | (input[sic].between(7690,7699)) | (input[sic].between(8100,8199)) | (input[sic].between(8200,8299)) | (input[sic].between(8300,8399)) | (input[sic].between(8400,8499)) | (input[sic].between(8600,8699)) | (input[sic].between(8800,8899)) | (input[sic].between(7510,7515)), description] = &#39;PerSv  Personal Services&#39;
    input.loc[(input[sic].between(2750,2759)) | (input[sic].between(3993,3993)) | (input[sic].between(7218,7218)) | (input[sic].between(7300,7300)) | (input[sic].between(7310,7319)) | (input[sic].between(7320,7329)) | (input[sic].between(7330,7339)) | (input[sic].between(7340,7342)) | (input[sic].between(7349,7349)) | (input[sic].between(7350,7351)) | (input[sic].between(7352,7352)) | (input[sic].between(7353,7353)) | (input[sic].between(7359,7359)) | (input[sic].between(7360,7369)) | (input[sic].between(7370,7372)) | (input[sic].between(7374,7374)) | (input[sic].between(7375,7375)) | (input[sic].between(7376,7376)) | (input[sic].between(7377,7377)) | (input[sic].between(7378,7378)) | (input[sic].between(7379,7379)) | (input[sic].between(7380,7380)) | (input[sic].between(7381,7382)) | (input[sic].between(7383,7383)) | (input[sic].between(7384,7384)) | (input[sic].between(7385,7385)) | (input[sic].between(7389,7390)) | (input[sic].between(7391,7391)) | (input[sic].between(7392,7392)) | (input[sic].between(7393,7393)) | (input[sic].between(7394,7394)) | (input[sic].between(7396,7396)) | (input[sic].between(7397,7397)) | (input[sic].between(7399,7399)) | (input[sic].between(7519,7519)) | (input[sic].between(8700,8700)) | (input[sic].between(8710,8713)) | (input[sic].between(8720,8721)) | (input[sic].between(8730,8734)) | (input[sic].between(8740,8748)) | (input[sic].between(8900,8910)) | (input[sic].between(8911,8911)) | (input[sic].between(8920,8999)) | (input[sic].between(4220,4229)), code] = 34
    if(description!=None):
        input.loc[(input[sic].between(2750,2759)) | (input[sic].between(3993,3993)) | (input[sic].between(7218,7218)) | (input[sic].between(7300,7300)) | (input[sic].between(7310,7319)) | (input[sic].between(7320,7329)) | (input[sic].between(7330,7339)) | (input[sic].between(7340,7342)) | (input[sic].between(7349,7349)) | (input[sic].between(7350,7351)) | (input[sic].between(7352,7352)) | (input[sic].between(7353,7353)) | (input[sic].between(7359,7359)) | (input[sic].between(7360,7369)) | (input[sic].between(7370,7372)) | (input[sic].between(7374,7374)) | (input[sic].between(7375,7375)) | (input[sic].between(7376,7376)) | (input[sic].between(7377,7377)) | (input[sic].between(7378,7378)) | (input[sic].between(7379,7379)) | (input[sic].between(7380,7380)) | (input[sic].between(7381,7382)) | (input[sic].between(7383,7383)) | (input[sic].between(7384,7384)) | (input[sic].between(7385,7385)) | (input[sic].between(7389,7390)) | (input[sic].between(7391,7391)) | (input[sic].between(7392,7392)) | (input[sic].between(7393,7393)) | (input[sic].between(7394,7394)) | (input[sic].between(7396,7396)) | (input[sic].between(7397,7397)) | (input[sic].between(7399,7399)) | (input[sic].between(7519,7519)) | (input[sic].between(8700,8700)) | (input[sic].between(8710,8713)) | (input[sic].between(8720,8721)) | (input[sic].between(8730,8734)) | (input[sic].between(8740,8748)) | (input[sic].between(8900,8910)) | (input[sic].between(8911,8911)) | (input[sic].between(8920,8999)) | (input[sic].between(4220,4229)), description] = &#39;BusSv  Business Services&#39;
    input.loc[(input[sic].between(3570,3579)) | (input[sic].between(3680,3680)) | (input[sic].between(3681,3681)) | (input[sic].between(3682,3682)) | (input[sic].between(3683,3683)) | (input[sic].between(3684,3684)) | (input[sic].between(3685,3685)) | (input[sic].between(3686,3686)) | (input[sic].between(3687,3687)) | (input[sic].between(3688,3688)) | (input[sic].between(3689,3689)) | (input[sic].between(3695,3695)) | (input[sic].between(7373,7373)), code] = 35
    if(description!=None):
        input.loc[(input[sic].between(3570,3579)) | (input[sic].between(3680,3680)) | (input[sic].between(3681,3681)) | (input[sic].between(3682,3682)) | (input[sic].between(3683,3683)) | (input[sic].between(3684,3684)) | (input[sic].between(3685,3685)) | (input[sic].between(3686,3686)) | (input[sic].between(3687,3687)) | (input[sic].between(3688,3688)) | (input[sic].between(3689,3689)) | (input[sic].between(3695,3695)) | (input[sic].between(7373,7373)), description] = &#39;Comps  Computers&#39;
    input.loc[(input[sic].between(3622,3622)) | (input[sic].between(3661,3661)) | (input[sic].between(3662,3662)) | (input[sic].between(3663,3663)) | (input[sic].between(3664,3664)) | (input[sic].between(3665,3665)) | (input[sic].between(3666,3666)) | (input[sic].between(3669,3669)) | (input[sic].between(3670,3679)) | (input[sic].between(3810,3810)) | (input[sic].between(3812,3812)), code] = 36
    if(description!=None):
        input.loc[(input[sic].between(3622,3622)) | (input[sic].between(3661,3661)) | (input[sic].between(3662,3662)) | (input[sic].between(3663,3663)) | (input[sic].between(3664,3664)) | (input[sic].between(3665,3665)) | (input[sic].between(3666,3666)) | (input[sic].between(3669,3669)) | (input[sic].between(3670,3679)) | (input[sic].between(3810,3810)) | (input[sic].between(3812,3812)), description] = &#39;Chips  Electronic Equipment&#39;
    input.loc[(input[sic].between(3811,3811)) | (input[sic].between(3820,3820)) | (input[sic].between(3821,3821)) | (input[sic].between(3822,3822)) | (input[sic].between(3823,3823)) | (input[sic].between(3824,3824)) | (input[sic].between(3825,3825)) | (input[sic].between(3826,3826)) | (input[sic].between(3827,3827)) | (input[sic].between(3829,3829)) | (input[sic].between(3830,3839)), code] = 37
    if(description!=None):
        input.loc[(input[sic].between(3811,3811)) | (input[sic].between(3820,3820)) | (input[sic].between(3821,3821)) | (input[sic].between(3822,3822)) | (input[sic].between(3823,3823)) | (input[sic].between(3824,3824)) | (input[sic].between(3825,3825)) | (input[sic].between(3826,3826)) | (input[sic].between(3827,3827)) | (input[sic].between(3829,3829)) | (input[sic].between(3830,3839)), description] = &#39;LabEq  Measuring and Control Equipment&#39;
    input.loc[(input[sic].between(2520,2549)) | (input[sic].between(2600,2639)) | (input[sic].between(2670,2699)) | (input[sic].between(2760,2761)) | (input[sic].between(3950,3955)), code] = 38
    if(description!=None):
        input.loc[(input[sic].between(2520,2549)) | (input[sic].between(2600,2639)) | (input[sic].between(2670,2699)) | (input[sic].between(2760,2761)) | (input[sic].between(3950,3955)), description] = &#39;Paper  Business Supplies&#39;
    input.loc[(input[sic].between(2440,2449)) | (input[sic].between(2640,2659)) | (input[sic].between(3220,3221)) | (input[sic].between(3410,3412)), code] = 39
    if(description!=None):
        input.loc[(input[sic].between(2440,2449)) | (input[sic].between(2640,2659)) | (input[sic].between(3220,3221)) | (input[sic].between(3410,3412)), description] = &#39;Boxes  Shipping Containers&#39;
    input.loc[(input[sic].between(4000,4013)) | (input[sic].between(4040,4049)) | (input[sic].between(4100,4100)) | (input[sic].between(4110,4119)) | (input[sic].between(4120,4121)) | (input[sic].between(4130,4131)) | (input[sic].between(4140,4142)) | (input[sic].between(4150,4151)) | (input[sic].between(4170,4173)) | (input[sic].between(4190,4199)) | (input[sic].between(4200,4200)) | (input[sic].between(4210,4219)) | (input[sic].between(4230,4231)) | (input[sic].between(4240,4249)) | (input[sic].between(4400,4499)) | (input[sic].between(4500,4599)) | (input[sic].between(4600,4699)) | (input[sic].between(4700,4700)) | (input[sic].between(4710,4712)) | (input[sic].between(4720,4729)) | (input[sic].between(4730,4739)) | (input[sic].between(4740,4749)) | (input[sic].between(4780,4780)) | (input[sic].between(4782,4782)) | (input[sic].between(4783,4783)) | (input[sic].between(4784,4784)) | (input[sic].between(4785,4785)) | (input[sic].between(4789,4789)), code] = 40
    if(description!=None):
        input.loc[(input[sic].between(4000,4013)) | (input[sic].between(4040,4049)) | (input[sic].between(4100,4100)) | (input[sic].between(4110,4119)) | (input[sic].between(4120,4121)) | (input[sic].between(4130,4131)) | (input[sic].between(4140,4142)) | (input[sic].between(4150,4151)) | (input[sic].between(4170,4173)) | (input[sic].between(4190,4199)) | (input[sic].between(4200,4200)) | (input[sic].between(4210,4219)) | (input[sic].between(4230,4231)) | (input[sic].between(4240,4249)) | (input[sic].between(4400,4499)) | (input[sic].between(4500,4599)) | (input[sic].between(4600,4699)) | (input[sic].between(4700,4700)) | (input[sic].between(4710,4712)) | (input[sic].between(4720,4729)) | (input[sic].between(4730,4739)) | (input[sic].between(4740,4749)) | (input[sic].between(4780,4780)) | (input[sic].between(4782,4782)) | (input[sic].between(4783,4783)) | (input[sic].between(4784,4784)) | (input[sic].between(4785,4785)) | (input[sic].between(4789,4789)), description] = &#39;Trans  Transportation&#39;
    input.loc[(input[sic].between(5000,5000)) | (input[sic].between(5010,5015)) | (input[sic].between(5020,5023)) | (input[sic].between(5030,5039)) | (input[sic].between(5040,5042)) | (input[sic].between(5043,5043)) | (input[sic].between(5044,5044)) | (input[sic].between(5045,5045)) | (input[sic].between(5046,5046)) | (input[sic].between(5047,5047)) | (input[sic].between(5048,5048)) | (input[sic].between(5049,5049)) | (input[sic].between(5050,5059)) | (input[sic].between(5060,5060)) | (input[sic].between(5063,5063)) | (input[sic].between(5064,5064)) | (input[sic].between(5065,5065)) | (input[sic].between(5070,5078)) | (input[sic].between(5080,5080)) | (input[sic].between(5081,5081)) | (input[sic].between(5082,5082)) | (input[sic].between(5083,5083)) | (input[sic].between(5084,5084)) | (input[sic].between(5085,5085)) | (input[sic].between(5086,5087)) | (input[sic].between(5088,5088)) | (input[sic].between(5090,5090)) | (input[sic].between(5091,5092)) | (input[sic].between(5093,5093)) | (input[sic].between(5094,5094)) | (input[sic].between(5099,5099)) | (input[sic].between(5100,5100)) | (input[sic].between(5110,5113)) | (input[sic].between(5120,5122)) | (input[sic].between(5130,5139)) | (input[sic].between(5140,5149)) | (input[sic].between(5150,5159)) | (input[sic].between(5160,5169)) | (input[sic].between(5170,5172)) | (input[sic].between(5180,5182)) | (input[sic].between(5190,5199)), code] = 41
    if(description!=None):
        input.loc[(input[sic].between(5000,5000)) | (input[sic].between(5010,5015)) | (input[sic].between(5020,5023)) | (input[sic].between(5030,5039)) | (input[sic].between(5040,5042)) | (input[sic].between(5043,5043)) | (input[sic].between(5044,5044)) | (input[sic].between(5045,5045)) | (input[sic].between(5046,5046)) | (input[sic].between(5047,5047)) | (input[sic].between(5048,5048)) | (input[sic].between(5049,5049)) | (input[sic].between(5050,5059)) | (input[sic].between(5060,5060)) | (input[sic].between(5063,5063)) | (input[sic].between(5064,5064)) | (input[sic].between(5065,5065)) | (input[sic].between(5070,5078)) | (input[sic].between(5080,5080)) | (input[sic].between(5081,5081)) | (input[sic].between(5082,5082)) | (input[sic].between(5083,5083)) | (input[sic].between(5084,5084)) | (input[sic].between(5085,5085)) | (input[sic].between(5086,5087)) | (input[sic].between(5088,5088)) | (input[sic].between(5090,5090)) | (input[sic].between(5091,5092)) | (input[sic].between(5093,5093)) | (input[sic].between(5094,5094)) | (input[sic].between(5099,5099)) | (input[sic].between(5100,5100)) | (input[sic].between(5110,5113)) | (input[sic].between(5120,5122)) | (input[sic].between(5130,5139)) | (input[sic].between(5140,5149)) | (input[sic].between(5150,5159)) | (input[sic].between(5160,5169)) | (input[sic].between(5170,5172)) | (input[sic].between(5180,5182)) | (input[sic].between(5190,5199)), description] = &#39;Whlsl  Wholesale&#39;
    input.loc[(input[sic].between(5200,5200)) | (input[sic].between(5210,5219)) | (input[sic].between(5220,5229)) | (input[sic].between(5230,5231)) | (input[sic].between(5250,5251)) | (input[sic].between(5260,5261)) | (input[sic].between(5270,5271)) | (input[sic].between(5300,5300)) | (input[sic].between(5310,5311)) | (input[sic].between(5320,5320)) | (input[sic].between(5330,5331)) | (input[sic].between(5334,5334)) | (input[sic].between(5340,5349)) | (input[sic].between(5390,5399)) | (input[sic].between(5400,5400)) | (input[sic].between(5410,5411)) | (input[sic].between(5412,5412)) | (input[sic].between(5420,5429)) | (input[sic].between(5430,5439)) | (input[sic].between(5440,5449)) | (input[sic].between(5450,5459)) | (input[sic].between(5460,5469)) | (input[sic].between(5490,5499)) | (input[sic].between(5500,5500)) | (input[sic].between(5510,5529)) | (input[sic].between(5530,5539)) | (input[sic].between(5540,5549)) | (input[sic].between(5550,5559)) | (input[sic].between(5560,5569)) | (input[sic].between(5570,5579)) | (input[sic].between(5590,5599)) | (input[sic].between(5600,5699)) | (input[sic].between(5700,5700)) | (input[sic].between(5710,5719)) | (input[sic].between(5720,5722)) | (input[sic].between(5730,5733)) | (input[sic].between(5734,5734)) | (input[sic].between(5735,5735)) | (input[sic].between(5736,5736)) | (input[sic].between(5750,5799)) | (input[sic].between(5900,5900)) | (input[sic].between(5910,5912)) | (input[sic].between(5920,5929)) | (input[sic].between(5930,5932)) | (input[sic].between(5940,5940)) | (input[sic].between(5941,5941)) | (input[sic].between(5942,5942)) | (input[sic].between(5943,5943)) | (input[sic].between(5944,5944)) | (input[sic].between(5945,5945)) | (input[sic].between(5946,5946)) | (input[sic].between(5947,5947)) | (input[sic].between(5948,5948)) | (input[sic].between(5949,5949)) | (input[sic].between(5950,5959)) | (input[sic].between(5960,5969)) | (input[sic].between(5970,5979)) | (input[sic].between(5980,5989)) | (input[sic].between(5990,5990)) | (input[sic].between(5992,5992)) | (input[sic].between(5993,5993)) | (input[sic].between(5994,5994)) | (input[sic].between(5995,5995)) | (input[sic].between(5999,5999)), code] = 42
    if(description!=None):
        input.loc[(input[sic].between(5200,5200)) | (input[sic].between(5210,5219)) | (input[sic].between(5220,5229)) | (input[sic].between(5230,5231)) | (input[sic].between(5250,5251)) | (input[sic].between(5260,5261)) | (input[sic].between(5270,5271)) | (input[sic].between(5300,5300)) | (input[sic].between(5310,5311)) | (input[sic].between(5320,5320)) | (input[sic].between(5330,5331)) | (input[sic].between(5334,5334)) | (input[sic].between(5340,5349)) | (input[sic].between(5390,5399)) | (input[sic].between(5400,5400)) | (input[sic].between(5410,5411)) | (input[sic].between(5412,5412)) | (input[sic].between(5420,5429)) | (input[sic].between(5430,5439)) | (input[sic].between(5440,5449)) | (input[sic].between(5450,5459)) | (input[sic].between(5460,5469)) | (input[sic].between(5490,5499)) | (input[sic].between(5500,5500)) | (input[sic].between(5510,5529)) | (input[sic].between(5530,5539)) | (input[sic].between(5540,5549)) | (input[sic].between(5550,5559)) | (input[sic].between(5560,5569)) | (input[sic].between(5570,5579)) | (input[sic].between(5590,5599)) | (input[sic].between(5600,5699)) | (input[sic].between(5700,5700)) | (input[sic].between(5710,5719)) | (input[sic].between(5720,5722)) | (input[sic].between(5730,5733)) | (input[sic].between(5734,5734)) | (input[sic].between(5735,5735)) | (input[sic].between(5736,5736)) | (input[sic].between(5750,5799)) | (input[sic].between(5900,5900)) | (input[sic].between(5910,5912)) | (input[sic].between(5920,5929)) | (input[sic].between(5930,5932)) | (input[sic].between(5940,5940)) | (input[sic].between(5941,5941)) | (input[sic].between(5942,5942)) | (input[sic].between(5943,5943)) | (input[sic].between(5944,5944)) | (input[sic].between(5945,5945)) | (input[sic].between(5946,5946)) | (input[sic].between(5947,5947)) | (input[sic].between(5948,5948)) | (input[sic].between(5949,5949)) | (input[sic].between(5950,5959)) | (input[sic].between(5960,5969)) | (input[sic].between(5970,5979)) | (input[sic].between(5980,5989)) | (input[sic].between(5990,5990)) | (input[sic].between(5992,5992)) | (input[sic].between(5993,5993)) | (input[sic].between(5994,5994)) | (input[sic].between(5995,5995)) | (input[sic].between(5999,5999)), description] = &#39;Rtail  Retail&#39;
    input.loc[(input[sic].between(5800,5819)) | (input[sic].between(5820,5829)) | (input[sic].between(5890,5899)) | (input[sic].between(7000,7000)) | (input[sic].between(7010,7019)) | (input[sic].between(7040,7049)) | (input[sic].between(7213,7213)), code] = 43
    if(description!=None):
        input.loc[(input[sic].between(5800,5819)) | (input[sic].between(5820,5829)) | (input[sic].between(5890,5899)) | (input[sic].between(7000,7000)) | (input[sic].between(7010,7019)) | (input[sic].between(7040,7049)) | (input[sic].between(7213,7213)), description] = &#39;Meals  Restaurants, Hotels, Motels&#39;
    input.loc[(input[sic].between(6000,6000)) | (input[sic].between(6010,6019)) | (input[sic].between(6020,6020)) | (input[sic].between(6021,6021)) | (input[sic].between(6022,6022)) | (input[sic].between(6023,6024)) | (input[sic].between(6025,6025)) | (input[sic].between(6026,6026)) | (input[sic].between(6027,6027)) | (input[sic].between(6028,6029)) | (input[sic].between(6030,6036)) | (input[sic].between(6040,6059)) | (input[sic].between(6060,6062)) | (input[sic].between(6080,6082)) | (input[sic].between(6090,6099)) | (input[sic].between(6100,6100)) | (input[sic].between(6110,6111)) | (input[sic].between(6112,6113)) | (input[sic].between(6120,6129)) | (input[sic].between(6130,6139)) | (input[sic].between(6140,6149)) | (input[sic].between(6150,6159)) | (input[sic].between(6160,6169)) | (input[sic].between(6170,6179)) | (input[sic].between(6190,6199)), code] = 44
    if(description!=None):
        input.loc[(input[sic].between(6000,6000)) | (input[sic].between(6010,6019)) | (input[sic].between(6020,6020)) | (input[sic].between(6021,6021)) | (input[sic].between(6022,6022)) | (input[sic].between(6023,6024)) | (input[sic].between(6025,6025)) | (input[sic].between(6026,6026)) | (input[sic].between(6027,6027)) | (input[sic].between(6028,6029)) | (input[sic].between(6030,6036)) | (input[sic].between(6040,6059)) | (input[sic].between(6060,6062)) | (input[sic].between(6080,6082)) | (input[sic].between(6090,6099)) | (input[sic].between(6100,6100)) | (input[sic].between(6110,6111)) | (input[sic].between(6112,6113)) | (input[sic].between(6120,6129)) | (input[sic].between(6130,6139)) | (input[sic].between(6140,6149)) | (input[sic].between(6150,6159)) | (input[sic].between(6160,6169)) | (input[sic].between(6170,6179)) | (input[sic].between(6190,6199)), description] = &#39;Banks  Banking&#39;
    input.loc[(input[sic].between(6300,6300)) | (input[sic].between(6310,6319)) | (input[sic].between(6320,6329)) | (input[sic].between(6330,6331)) | (input[sic].between(6350,6351)) | (input[sic].between(6360,6361)) | (input[sic].between(6370,6379)) | (input[sic].between(6390,6399)) | (input[sic].between(6400,6411)), code] = 45
    if(description!=None):
        input.loc[(input[sic].between(6300,6300)) | (input[sic].between(6310,6319)) | (input[sic].between(6320,6329)) | (input[sic].between(6330,6331)) | (input[sic].between(6350,6351)) | (input[sic].between(6360,6361)) | (input[sic].between(6370,6379)) | (input[sic].between(6390,6399)) | (input[sic].between(6400,6411)), description] = &#39;Insur  Insurance&#39;
    input.loc[(input[sic].between(6500,6500)) | (input[sic].between(6510,6510)) | (input[sic].between(6512,6512)) | (input[sic].between(6513,6513)) | (input[sic].between(6514,6514)) | (input[sic].between(6515,6515)) | (input[sic].between(6517,6519)) | (input[sic].between(6520,6529)) | (input[sic].between(6530,6531)) | (input[sic].between(6532,6532)) | (input[sic].between(6540,6541)) | (input[sic].between(6550,6553)) | (input[sic].between(6590,6599)) | (input[sic].between(6610,6611)), code] = 46
    if(description!=None):
        input.loc[(input[sic].between(6500,6500)) | (input[sic].between(6510,6510)) | (input[sic].between(6512,6512)) | (input[sic].between(6513,6513)) | (input[sic].between(6514,6514)) | (input[sic].between(6515,6515)) | (input[sic].between(6517,6519)) | (input[sic].between(6520,6529)) | (input[sic].between(6530,6531)) | (input[sic].between(6532,6532)) | (input[sic].between(6540,6541)) | (input[sic].between(6550,6553)) | (input[sic].between(6590,6599)) | (input[sic].between(6610,6611)), description] = &#39;RlEst  Real Estate&#39;
    input.loc[(input[sic].between(6200,6299)) | (input[sic].between(6700,6700)) | (input[sic].between(6710,6719)) | (input[sic].between(6720,6722)) | (input[sic].between(6723,6723)) | (input[sic].between(6724,6724)) | (input[sic].between(6725,6725)) | (input[sic].between(6726,6726)) | (input[sic].between(6730,6733)) | (input[sic].between(6740,6779)) | (input[sic].between(6790,6791)) | (input[sic].between(6792,6792)) | (input[sic].between(6793,6793)) | (input[sic].between(6794,6794)) | (input[sic].between(6795,6795)) | (input[sic].between(6798,6798)) | (input[sic].between(6799,6799)), code] = 47
    if(description!=None):
        input.loc[(input[sic].between(6200,6299)) | (input[sic].between(6700,6700)) | (input[sic].between(6710,6719)) | (input[sic].between(6720,6722)) | (input[sic].between(6723,6723)) | (input[sic].between(6724,6724)) | (input[sic].between(6725,6725)) | (input[sic].between(6726,6726)) | (input[sic].between(6730,6733)) | (input[sic].between(6740,6779)) | (input[sic].between(6790,6791)) | (input[sic].between(6792,6792)) | (input[sic].between(6793,6793)) | (input[sic].between(6794,6794)) | (input[sic].between(6795,6795)) | (input[sic].between(6798,6798)) | (input[sic].between(6799,6799)), description] = &#39;Fin    Trading&#39;
    input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), code] = 48
    if(description!=None):
        input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), description] = &#39;Other  Almost Nothing&#39;
    return input</code></pre>
</details>
</dd>
<dt id="brt.add_ff5"><code class="name flex">
<span>def <span class="ident">add_ff5</span></span>(<span>input: pandas.core.frame.DataFrame, sic: str = 'sic', code: str = 'ff5', description: str = None)</span>
</code></dt>
<dd>
<div class="desc"><p>Add Fama-French 5-factor code and description.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>TYPE</code></dt>
<dd>Input data.</dd>
<dt><strong><code>sic</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>SIC column name. The default is 'sic'.</dd>
<dt><strong><code>code</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>FF5 output column name. The default is 'ff5'.</dd>
<dt><strong><code>description</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>FF5 description output column name. Description will only be added if it is not None. The default is None.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>TYPE</code></dt>
<dd>DataFrame with added FF5 code and description if 'description' is not None.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_ff5(input:pd.DataFrame , sic: str = &#39;sic&#39;, code: str = &#39;ff5&#39;, description: str = None):
    &#39;&#39;&#39;    
    Add Fama-French 5-factor code and description.

    Parameters
    ----------
    input : TYPE
        Input data.
    sic : str, optional
        SIC column name. The default is &#39;sic&#39;.
    code : str, optional
        FF5 output column name. The default is &#39;ff5&#39;.
    description : str, optional
        FF5 description output column name. Description will only be added if it is not None. The default is None.

    Returns
    -------
    input : TYPE
        DataFrame with added FF5 code and description if &#39;description&#39; is not None.

    &#39;&#39;&#39;
    
     
    input[code] = np.nan
    if(description!=None):
        input[description] = np.nan
    input.loc[(input[sic].between(100,999)) | (input[sic].between(2000,2399)) | (input[sic].between(2700,2749)) | (input[sic].between(2770,2799)) | (input[sic].between(3100,3199)) | (input[sic].between(3940,3989)) | (input[sic].between(2500,2519)) | (input[sic].between(2590,2599)) | (input[sic].between(3630,3659)) | (input[sic].between(3710,3711)) | (input[sic].between(3714,3714)) | (input[sic].between(3716,3716)) | (input[sic].between(3750,3751)) | (input[sic].between(3792,3792)) | (input[sic].between(3900,3939)) | (input[sic].between(3990,3999)) | (input[sic].between(5000,5999)) | (input[sic].between(7200,7299)) | (input[sic].between(7600,7699)), code] = 1
    if(description!=None):
        input.loc[(input[sic].between(100,999)) | (input[sic].between(2000,2399)) | (input[sic].between(2700,2749)) | (input[sic].between(2770,2799)) | (input[sic].between(3100,3199)) | (input[sic].between(3940,3989)) | (input[sic].between(2500,2519)) | (input[sic].between(2590,2599)) | (input[sic].between(3630,3659)) | (input[sic].between(3710,3711)) | (input[sic].between(3714,3714)) | (input[sic].between(3716,3716)) | (input[sic].between(3750,3751)) | (input[sic].between(3792,3792)) | (input[sic].between(3900,3939)) | (input[sic].between(3990,3999)) | (input[sic].between(5000,5999)) | (input[sic].between(7200,7299)) | (input[sic].between(7600,7699)), description] = &#39;Cnsmr  Consumer Durables, Nondurables, Wholesale, Retail, and Some Services (Laundries, Repair Shops)&#39;
    input.loc[(input[sic].between(2520,2589)) | (input[sic].between(2600,2699)) | (input[sic].between(2750,2769)) | (input[sic].between(2800,2829)) | (input[sic].between(2840,2899)) | (input[sic].between(3000,3099)) | (input[sic].between(3200,3569)) | (input[sic].between(3580,3621)) | (input[sic].between(3623,3629)) | (input[sic].between(3700,3709)) | (input[sic].between(3712,3713)) | (input[sic].between(3715,3715)) | (input[sic].between(3717,3749)) | (input[sic].between(3752,3791)) | (input[sic].between(3793,3799)) | (input[sic].between(3860,3899)) | (input[sic].between(1200,1399)) | (input[sic].between(2900,2999)) | (input[sic].between(4900,4949)), code] = 2
    if(description!=None):
        input.loc[(input[sic].between(2520,2589)) | (input[sic].between(2600,2699)) | (input[sic].between(2750,2769)) | (input[sic].between(2800,2829)) | (input[sic].between(2840,2899)) | (input[sic].between(3000,3099)) | (input[sic].between(3200,3569)) | (input[sic].between(3580,3621)) | (input[sic].between(3623,3629)) | (input[sic].between(3700,3709)) | (input[sic].between(3712,3713)) | (input[sic].between(3715,3715)) | (input[sic].between(3717,3749)) | (input[sic].between(3752,3791)) | (input[sic].between(3793,3799)) | (input[sic].between(3860,3899)) | (input[sic].between(1200,1399)) | (input[sic].between(2900,2999)) | (input[sic].between(4900,4949)), description] = &#39;Manuf  Manufacturing, Energy, and Utilities&#39;
    input.loc[(input[sic].between(3570,3579)) | (input[sic].between(3622,3622)) | (input[sic].between(3660,3692)) | (input[sic].between(3694,3699)) | (input[sic].between(3810,3839)) | (input[sic].between(7370,7372)) | (input[sic].between(7373,7373)) | (input[sic].between(7374,7374)) | (input[sic].between(7375,7375)) | (input[sic].between(7376,7376)) | (input[sic].between(7377,7377)) | (input[sic].between(7378,7378)) | (input[sic].between(7379,7379)) | (input[sic].between(7391,7391)) | (input[sic].between(8730,8734)) | (input[sic].between(4800,4899)), code] = 3
    if(description!=None):
        input.loc[(input[sic].between(3570,3579)) | (input[sic].between(3622,3622)) | (input[sic].between(3660,3692)) | (input[sic].between(3694,3699)) | (input[sic].between(3810,3839)) | (input[sic].between(7370,7372)) | (input[sic].between(7373,7373)) | (input[sic].between(7374,7374)) | (input[sic].between(7375,7375)) | (input[sic].between(7376,7376)) | (input[sic].between(7377,7377)) | (input[sic].between(7378,7378)) | (input[sic].between(7379,7379)) | (input[sic].between(7391,7391)) | (input[sic].between(8730,8734)) | (input[sic].between(4800,4899)), description] = &#39;HiTec  Business Equipment, Telephone and Television Transmission&#39;
    input.loc[(input[sic].between(2830,2839)) | (input[sic].between(3693,3693)) | (input[sic].between(3840,3859)) | (input[sic].between(8000,8099)), code] = 4
    if(description!=None):
        input.loc[(input[sic].between(2830,2839)) | (input[sic].between(3693,3693)) | (input[sic].between(3840,3859)) | (input[sic].between(8000,8099)), description] = &#39;Hlth   Healthcare, Medical Equipment, and Drugs&#39;
    input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), code] = 5
    if(description!=None):
        input.loc[(input[sic].notnull()) &amp; (input[code].isnull()), description] = &#39;Other  Other -- Mines, Constr, BldMt, Trans, Hotels, Bus Serv, Entertainment, Finance&#39;
    return input</code></pre>
</details>
</dd>
<dt id="brt.add_permno"><code class="name flex">
<span>def <span class="ident">add_permno</span></span>(<span>input: pandas.core.frame.DataFrame, ccmxpf_lnkhist: pandas.core.frame.DataFrame)</span>
</code></dt>
<dd>
<div class="desc"><p>Add PERMNO column to CompuStat dataset. </p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd>CompuStat dataset. It must contain 'gvkey' and 'datadate' columns.</dd>
<dt><strong><code>ccmxpf_lnkhist</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd>ccmxpf_lnkhist dataset from CRSP.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>TYPE</code></dt>
<dd>CompuStat dataset with PERMNO column.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_permno(input: pd.DataFrame , ccmxpf_lnkhist: pd.DataFrame ):
    &#39;&#39;&#39;
    Add PERMNO column to CompuStat dataset. 
    

    Parameters
    ----------
    input : pd.DataFrame
        CompuStat dataset. It must contain &#39;gvkey&#39; and &#39;datadate&#39; columns.
    ccmxpf_lnkhist : pd.DataFrame
        ccmxpf_lnkhist dataset from CRSP.

    Returns
    -------
    input : TYPE
        CompuStat dataset with PERMNO column.

    &#39;&#39;&#39;   
    
        
    link = ccmxpf_lnkhist[ccmxpf_lnkhist.LINKTYPE.isin([&#34;LC&#34;,&#34;LS&#34;,&#34;LU&#34;]) &amp; ccmxpf_lnkhist.LINKPRIM.isin([&#39;P&#39;,&#39;C&#39;])]
    input = sqldf(&#34;select distinct input.*, link.LPERMNO as PERMNO from input, link where input.gvkey=link.gvkey and (input.datadate&gt;=link.LINKDT or link.LINKDT==NULL) and (input.datadate&lt;=link.LINKENDDT or link.LINKENDDT==NULL);&#34;, locals())
    return input</code></pre>
</details>
</dd>
<dt id="brt.get_comp"><code class="name flex">
<span>def <span class="ident">get_comp</span></span>(<span>input: pandas.core.frame.DataFrame)</span>
</code></dt>
<dd>
<div class="desc"><p>Filter Original CompuStat dataset as WRDS default.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd>Compustat dataset. It must contains 'datafmt', 'indfmt', 'consol', and 'popsrc' columns.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>TYPE</code></dt>
<dd>Filtered Compustat dataset.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_comp(input: pd.DataFrame):
    &#39;&#39;&#39;
    Filter Original CompuStat dataset as WRDS default.

    Parameters
    ----------
    input : pd.DataFrame
        Compustat dataset. It must contains &#39;datafmt&#39;, &#39;indfmt&#39;, &#39;consol&#39;, and &#39;popsrc&#39; columns.

    Returns
    -------
    TYPE
        Filtered Compustat dataset.

    &#39;&#39;&#39;
    
    
    return input[(input[&#39;datafmt&#39;]==&#39;STD&#39;) &amp; (input[&#39;indfmt&#39;]==&#39;INDL&#39;) &amp; (input[&#39;consol&#39;]==&#39;C&#39;) &amp; (input[&#39;popsrc&#39;]==&#39;D&#39;)]</code></pre>
</details>
</dd>
<dt id="brt.get_sas_columns"><code class="name flex">
<span>def <span class="ident">get_sas_columns</span></span>(<span>file_path: str, keys: list = None, charset: str = 'utf-8')</span>
</code></dt>
<dd>
<div class="desc"><p>Get the information for SAS file columns.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>file_path</code></strong> :&ensp;<code>str</code></dt>
<dd>SAS file path.</dd>
<dt><strong><code>keys</code></strong> :&ensp;<code>list</code>, optional</dt>
<dd>The list of column names. If None, all columns' information will be returned. The default is None.</dd>
<dt><strong><code>charset</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The charset of the SAS file. The default is 'utf-8'.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>TYPE</code></dt>
<dd>The names and types of columns specified by 'keys'.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_sas_columns(file_path: str, keys: list = None, charset:str = &#39;utf-8&#39;): 
    &#39;&#39;&#39;
    Get the information for SAS file columns.

    Parameters
    ----------
    file_path : str
        SAS file path.
    keys : list, optional
        The list of column names. If None, all columns&#39; information will be returned. The default is None.
    charset : str, optional
        The charset of the SAS file. The default is &#39;utf-8&#39;.

    Returns
    -------
    TYPE
        The names and types of columns specified by &#39;keys&#39;.

    &#39;&#39;&#39;
    return read_sas(file_path, keys = keys, chunksize = 1, charset = charset, batch = 0, progress=False).dtypes</code></pre>
</details>
</dd>
<dt id="brt.read_sas"><code class="name flex">
<span>def <span class="ident">read_sas</span></span>(<span>file_path: str, keys: list = None, chunksize: int = 10000, charset: str = 'utf-8', batch: int = None, progress: bool = True)</span>
</code></dt>
<dd>
<div class="desc"><p>Read sas file into a data frame.
</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>file_path</code></strong> :&ensp;<code>str</code></dt>
<dd>SAS file path.</dd>
<dt><strong><code>keys</code></strong> :&ensp;<code>list</code>, optional</dt>
<dd>The list of column names. If None, all columns' information will be returned. The default is None.</dd>
<dt><strong><code>chunksize</code></strong> :&ensp;<code>int</code>, optional</dt>
<dd>The number of rows read each time. Lowering this value may solve the out of memory problem while loading SAS dataset. The default is 10000.</dd>
<dt><strong><code>charset</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The charset of the SAS file. The default is 'utf-8'.</dd>
<dt><strong><code>batch</code></strong> :&ensp;<code>int</code>, optional</dt>
<dd>The number of times of reading the database by 'chunksize' rows. If it is None, all file will be read. The default is None.</dd>
<dt><strong><code>progress</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Whether shows the loading progress. The default is True.</dd>
</dl>
<h2 id="returns">Returns</h2>
<p>Read dataframe.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def read_sas(file_path: str, keys: list = None, chunksize:int = 10000, charset:str = &#39;utf-8&#39;, batch:int = None, progress:bool = True):
    &#39;&#39;&#39;
    Read sas file into a data frame.    

    Parameters
    ----------
    file_path : str
        SAS file path.
    keys : list, optional
        The list of column names. If None, all columns&#39; information will be returned. The default is None.
    chunksize : int, optional
        The number of rows read each time. Lowering this value may solve the out of memory problem while loading SAS dataset. The default is 10000.
    charset : str, optional
        The charset of the SAS file. The default is &#39;utf-8&#39;.
    batch : int, optional
        The number of times of reading the database by &#39;chunksize&#39; rows. If it is None, all file will be read. The default is None.
    progress : bool, optional
        Whether shows the loading progress. The default is True.

    Returns
    -------
    Read dataframe.

    &#39;&#39;&#39;    
    
    
    data = pd.DataFrame()
    for df in pd.read_sas(file_path, chunksize=chunksize):
        if(keys==None):
            data = data.append(df)
        else:
            data = data.append(df[keys])
        if(progress):
            print(&#39;.&#39;, sep=&#39; &#39;, end=&#39;&#39;, flush=True)
        if(batch!=None):
            if(batch&gt;0):
                batch-=1
            else:
                break
    for c in data.select_dtypes(include=[&#39;object&#39;]).columns:
        data[c] = data[c].str.decode(charset)
    return data</code></pre>
</details>
</dd>
<dt id="brt.remove_na_sic"><code class="name flex">
<span>def <span class="ident">remove_na_sic</span></span>(<span>input: pandas.core.frame.DataFrame, sic_field: str)</span>
</code></dt>
<dd>
<div class="desc"><p>Remove all observations without SIC</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd>Input dataset.</dd>
<dt><strong><code>sic_field</code></strong> :&ensp;<code>str</code></dt>
<dd>SIC column name.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>TYPE</code></dt>
<dd>Dataset withou any observations without SIC.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_na_sic(input: pd.DataFrame, sic_field: str):
    &#39;&#39;&#39;
    Remove all observations without SIC

    Parameters
    ----------
    input : pd.DataFrame
        Input dataset.
    sic_field : str
        SIC column name.

    Returns
    -------
    TYPE
        Dataset withou any observations without SIC.

    &#39;&#39;&#39;
    
    
    
    return input[(input[sic_field]&gt;=1) &amp; (input[sic_field]&lt;=9999)]</code></pre>
</details>
</dd>
<dt id="brt.remove_sic_between"><code class="name flex">
<span>def <span class="ident">remove_sic_between</span></span>(<span>input: pandas.core.frame.DataFrame, sic_field, sic_from, sic_to)</span>
</code></dt>
<dd>
<div class="desc"><p>Remove observations with SIC between 'sic_from' and 'sic_to'</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>input</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd>Input dataset.</dd>
<dt><strong><code>sic_field</code></strong> :&ensp;<code>str</code></dt>
<dd>SIC column name.</dd>
<dt><strong><code>sic_from</code></strong> :&ensp;<code>TYPE</code></dt>
<dd>The starting SIC code, inclusive.</dd>
<dt><strong><code>sic_to</code></strong> :&ensp;<code>TYPE</code></dt>
<dd>The ending SIC code, inclusive.</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>TYPE</code></dt>
<dd>DESCRIPTION.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_sic_between(input: pd.DataFrame, sic_field, sic_from, sic_to):
    &#39;&#39;&#39;
    Remove observations with SIC between &#39;sic_from&#39; and &#39;sic_to&#39;

    Parameters
    ----------
    input : pd.DataFrame
        Input dataset.
    sic_field : str
        SIC column name.
    sic_from : TYPE
        The starting SIC code, inclusive.
    sic_to : TYPE
        The ending SIC code, inclusive.

    Returns
    -------
    TYPE
        DESCRIPTION.

    &#39;&#39;&#39;
    
    return input[~((input[sic_field]&gt;=sic_from) &amp; (input[sic_field]&lt;=sic_to))]</code></pre>
</details>
</dd>
<dt id="brt.show_sas_columns"><code class="name flex">
<span>def <span class="ident">show_sas_columns</span></span>(<span>file_path: str, keys: list = None, charset: str = 'utf-8')</span>
</code></dt>
<dd>
<div class="desc"><p>Show the information for SAS file columns.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>file_path</code></strong> :&ensp;<code>str</code></dt>
<dd>SAS file path.</dd>
<dt><strong><code>keys</code></strong> :&ensp;<code>list</code>, optional</dt>
<dd>The list of column names. If None, all columns' information will be returned. The default is None.</dd>
<dt><strong><code>charset</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The charset of the SAS file. The default is 'utf-8'.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_sas_columns(file_path: str, keys: list = None, charset:str = &#39;utf-8&#39;): 
    &#39;&#39;&#39;
    Show the information for SAS file columns.

    Parameters
    ----------
    file_path : str
        SAS file path.
    keys : list, optional
        The list of column names. If None, all columns&#39; information will be returned. The default is None.
    charset : str, optional
        The charset of the SAS file. The default is &#39;utf-8&#39;.


    &#39;&#39;&#39;
    with pd.option_context(&#39;display.max_rows&#39;, None, &#39;display.max_columns&#39;, None):
        print(read_sas(file_path, keys = keys, chunksize = 1, charset = charset, batch = 0, progress=False).dtypes)</code></pre>
</details>
</dd>
<dt id="brt.winsorize"><code class="name flex">
<span>def <span class="ident">winsorize</span></span>(<span>data: pandas.core.frame.DataFrame, truncated: bool = False, columns: list = [], limits: float = 0.01, nan_policy='propagate')</span>
</code></dt>
<dd>
<div class="desc"><p>Winsorize columns.</p>
<h2 id="parameters">Parameters</h2>
<dl>
<dt><strong><code>data</code></strong> :&ensp;<code>pd.DataFrame</code></dt>
<dd>Input dataset.</dd>
<dt><strong><code>truncated</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>Whether the columns will be truncated. The default is False.</dd>
<dt><strong><code>columns</code></strong> :&ensp;<code>List</code>, optional</dt>
<dd>List of the names of columns to be winsorized. The default is [].</dd>
<dt><strong><code>limits</code></strong> :&ensp;<code>float</code>, optional</dt>
<dd>Winsorization limit. The default is 0.01.</dd>
</dl>
<p>nan_policy{‘propagate’, ‘raise’, ‘omit’}, optional
Defines how to handle when input contains nan. The following options are available (default is ‘propagate’):
‘propagate’: allows nan values and may overwrite or propagate them
‘raise’: throws an error
‘omit’: performs the calculations ignoring nan values
Returns</p>
<hr>
<dl>
<dt><strong><code>data</code></strong> :&ensp;<code>TYPE</code></dt>
<dd>Winsorized dataset.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def winsorize(data: pd.DataFrame, truncated:bool = False, columns:list = [], limits:float = 0.01, nan_policy = &#39;propagate&#39;):
    &#39;&#39;&#39;
    Winsorize columns.

    Parameters
    ----------
    data : pd.DataFrame
        Input dataset.
    truncated : bool, optional
        Whether the columns will be truncated. The default is False.
    columns : List, optional
        List of the names of columns to be winsorized. The default is [].
    limits : float, optional
        Winsorization limit. The default is 0.01.
    nan_policy{‘propagate’, ‘raise’, ‘omit’}, optional
        Defines how to handle when input contains nan. The following options are available (default is ‘propagate’):
            ‘propagate’: allows nan values and may overwrite or propagate them
            ‘raise’: throws an error
            ‘omit’: performs the calculations ignoring nan values
    Returns
    -------
    data : TYPE
        Winsorized dataset.

    &#39;&#39;&#39;
    
    for col in columns: 
         data[col] = stats.mstats.winsorize(data[col], limits=limits, inclusive = (truncated, truncated), nan_policy = nan_policy)
    return data</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="brt.Sample"><code class="flex name class">
<span>class <span class="ident">Sample</span></span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class Sample:
    
    
    
    def __init__(self):
        self.sample = pd.DataFrame(columns=[&#39;&#39;,&#39;Observations&#39;])
    def add(self, data: pd.DataFrame, description: str):
        self.sample.loc[len(self.sample)] = [description, data.shape[0]]
    def save(self, path=&#39;data/sample.pkl&#39;):
        self.sample.to_pickle(path)
    def load(self, path=&#39;data/sample.pkl&#39;):
        self.sample = pd.read_pickle(path)
    def get(self):
        return self.sample
    def print(self):
        display(Markdown(self.sample.sample.to_markdown(index=False)))    </code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="brt.Sample.add"><code class="name flex">
<span>def <span class="ident">add</span></span>(<span>self, data: pandas.core.frame.DataFrame, description: str)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add(self, data: pd.DataFrame, description: str):
    self.sample.loc[len(self.sample)] = [description, data.shape[0]]</code></pre>
</details>
</dd>
<dt id="brt.Sample.get"><code class="name flex">
<span>def <span class="ident">get</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get(self):
    return self.sample</code></pre>
</details>
</dd>
<dt id="brt.Sample.load"><code class="name flex">
<span>def <span class="ident">load</span></span>(<span>self, path='data/sample.pkl')</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def load(self, path=&#39;data/sample.pkl&#39;):
    self.sample = pd.read_pickle(path)</code></pre>
</details>
</dd>
<dt id="brt.Sample.print"><code class="name flex">
<span>def <span class="ident">print</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def print(self):
    display(Markdown(self.sample.sample.to_markdown(index=False)))    </code></pre>
</details>
</dd>
<dt id="brt.Sample.save"><code class="name flex">
<span>def <span class="ident">save</span></span>(<span>self, path='data/sample.pkl')</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def save(self, path=&#39;data/sample.pkl&#39;):
    self.sample.to_pickle(path)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="two-column">
<li><code><a title="brt.add_ff12" href="#brt.add_ff12">add_ff12</a></code></li>
<li><code><a title="brt.add_ff38" href="#brt.add_ff38">add_ff38</a></code></li>
<li><code><a title="brt.add_ff48" href="#brt.add_ff48">add_ff48</a></code></li>
<li><code><a title="brt.add_ff5" href="#brt.add_ff5">add_ff5</a></code></li>
<li><code><a title="brt.add_permno" href="#brt.add_permno">add_permno</a></code></li>
<li><code><a title="brt.get_comp" href="#brt.get_comp">get_comp</a></code></li>
<li><code><a title="brt.get_sas_columns" href="#brt.get_sas_columns">get_sas_columns</a></code></li>
<li><code><a title="brt.read_sas" href="#brt.read_sas">read_sas</a></code></li>
<li><code><a title="brt.remove_na_sic" href="#brt.remove_na_sic">remove_na_sic</a></code></li>
<li><code><a title="brt.remove_sic_between" href="#brt.remove_sic_between">remove_sic_between</a></code></li>
<li><code><a title="brt.show_sas_columns" href="#brt.show_sas_columns">show_sas_columns</a></code></li>
<li><code><a title="brt.winsorize" href="#brt.winsorize">winsorize</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="brt.Sample" href="#brt.Sample">Sample</a></code></h4>
<ul class="">
<li><code><a title="brt.Sample.add" href="#brt.Sample.add">add</a></code></li>
<li><code><a title="brt.Sample.get" href="#brt.Sample.get">get</a></code></li>
<li><code><a title="brt.Sample.load" href="#brt.Sample.load">load</a></code></li>
<li><code><a title="brt.Sample.print" href="#brt.Sample.print">print</a></code></li>
<li><code><a title="brt.Sample.save" href="#brt.Sample.save">save</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.1</a>.</p>
</footer>
</body>
</html>